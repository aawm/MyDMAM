<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head><link rel="stylesheet" type="text/css" href="wp-content/cache/minify/000000/bcxJCoAwDAXQC1miJxJJfyVqk9IGxNs74MKFuwd_GIjNVkFQc2EQt0apmno30F6CW_Bd3FGf5HVIQLwKC7xMvNIoyjRDUYVN2z-7nvIR85Sp-bHhM7-fX58.css" media="all" />

	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>Setup | MyDMAM Project</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="http://mydmam.org/xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="http://mydmam.org/wp-content/themes/mydmam/js/html5.js"></script>
	<![endif]-->
	<link rel="alternate" type="application/rss+xml" title="MyDMAM Project &raquo; Feed" href="feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="MyDMAM Project &raquo; Comments Feed" href="http://mydmam.org/comments/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/mydmam.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=be63b55bd13097cdf910707a9a52c072"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;if(!g||!g.fillText)return!1;switch(g.textBaseline="top",g.font="600 32px Arial",a){case"flag":return g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3;case"diversity":return g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,d=c[0]+","+c[1]+","+c[2]+","+c[3],g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e;case"simple":return g.fillText(h(55357,56835),0,0),0!==g.getImageData(16,16,1,1).data[0];case"unicode8":return g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>


<link rel='stylesheet' id='twentythirteen-fonts-css'  href='http://fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic%7CBitter%3A400%2C700&amp;subset=latin%2Clatin-ext' type='text/css' media='all' />


<!--[if lt IE 9]>
<link rel='stylesheet' id='twentythirteen-ie-css'  href='http://mydmam.org/wp-content/themes/mydmam/css/ie.css?ver=2013-07-18' type='text/css' media='all' />
<![endif]-->

<!-- This site uses the Google Analytics by MonsterInsights plugin v5.5 - Universal disabled - https://www.monsterinsights.com/ -->
<script type="text/javascript">

	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-43522802-1']);
	_gaq.push(['_gat._forceSSL']);
	_gaq.push(['_trackPageview']);

	(function () {
		var ga = document.createElement('script');
		ga.type = 'text/javascript';
		ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(ga, s);
	})();

</script>
<!-- / Google Analytics by MonsterInsights -->
<script type="text/javascript" src="wp-content/cache/minify/000000/M9bPKixNLarUMYYydHMz04sSS1L1cjPzAA.js"></script>
<script type='text/javascript'>
/* <![CDATA[ */
var cnArgs = {"ajaxurl":"http:\/\/mydmam.org\/wp-admin\/admin-ajax.php","hideEffect":"fade","onScroll":"yes","onScrollOffset":"100","cookieName":"cookie_notice_accepted","cookieValue":"TRUE","cookieTime":"31536000","cookiePath":"\/","cookieDomain":""};
/* ]]> */
</script>
<script type="text/javascript" src="wp-content/cache/minify/000000/M9RPzs_PzkzVzcsvyUxO1c8q1k8rys8rAQA.js"></script>
<link rel='https://api.w.org/' href='http://mydmam.org/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="index.html%3Fp=15.html" />
<link rel='shortlink' href='index.html%3Fp=15.html' />
<link rel="alternate" type="application/json+oembed" href="http://mydmam.org/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fmydmam.org%2Fsetup%2F" />
<link rel="alternate" type="text/xml+oembed" href="http://mydmam.org/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fmydmam.org%2Fsetup%2F&#038;format=xml" />
<script type="text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//mydmam.org/?wordfence_logHuman=1&hid=7BCBBC6CF7DD115ECD01E544FC21B5A6');
</script><style type='text/css'>img#wpstats{display:none}</style>	<style type="text/css" id="twentythirteen-header-css">
			.site-header {
			background: url(wp-content/uploads/2013/12/Entete-MyDMAM-site-01.png) no-repeat scroll top;
			background-size: 1600px auto;
		}
			.site-title,
		.site-description {
			position: absolute;
			clip: rect(1px 1px 1px 1px); /* IE7 */
			clip: rect(1px, 1px, 1px, 1px);
		}
		</style>
	<link rel="icon" href="wp-content/uploads/2016/05/cropped-Favicon-MyDMAM-tres-grande-zoom-32x32.png" sizes="32x32" />
<link rel="icon" href="wp-content/uploads/2016/05/cropped-Favicon-MyDMAM-tres-grande-zoom-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="wp-content/uploads/2016/05/cropped-Favicon-MyDMAM-tres-grande-zoom-180x180.png" />
<meta name="msapplication-TileImage" content="http://mydmam.org/wp-content/uploads/2016/05/cropped-Favicon-MyDMAM-tres-grande-zoom-270x270.png" />
</head>

<body class="page page-id-15 page-parent page-template-default single-author">
	<div id="page" class="hfeed site">
		<header id="masthead" class="site-header" role="banner">
			<a class="home-link" href="index.html" title="MyDMAM Project" rel="home">
				<h1 class="site-title">MyDMAM Project</h1>
				<h2 class="site-description">Another way of looking a Digital Media Asset Management</h2>
			</a>

			<div id="navbar" class="navbar">
				<nav id="site-navigation" class="navigation main-navigation" role="navigation">
					<h3 class="menu-toggle">Menu</h3>
					<a class="screen-reader-text skip-link" href="index.html%3Fp=15.html#content" title="Skip to content">Skip to content</a>
					<div class="menu-menu-1-container"><ul id="menu-menu-1" class="nav-menu"><li id="menu-item-286" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-286"><a href="index.html">Welcome</a>
<ul class="sub-menu">
	<li id="menu-item-284" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-284"><a href="index.html%3Fp=190.html">Introducing</a></li>
	<li id="menu-item-285" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-285"><a href="index.html%3Fp=64.html">Présentation du projet</a></li>
	<li id="menu-item-287" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-287"><a href="index.html%3Fp=89.html">Questions fréquentes</a></li>
</ul>
</li>
<li id="menu-item-375" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-375"><a href="category/news/index.html">News</a></li>
<li id="menu-item-105" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-105"><a href="index.html%3Fp=67.html">Downloads</a>
<ul class="sub-menu">
	<li id="menu-item-265" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-265"><a href="index.html%3Fp=262.html">Offline website mode</a></li>
</ul>
</li>
<li id="menu-item-169" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-15 current_page_item menu-item-has-children menu-item-169"><a href="index.html%3Fp=15.html">Setup</a>
<ul class="sub-menu">
	<li id="menu-item-225" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-225"><a href="index.html%3Fp=223.html">ACL et Authentification (fr)</a></li>
	<li id="menu-item-275" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-275"><a title="Setup a Play hosting through in a subdirectory in Apache SSL virtualhost" href="index.html%3Fp=270.html">Play through Apache SSL</a></li>
</ul>
</li>
<li id="menu-item-243" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-243"><a href="index.html%3Fp=136.html">Developments</a>
<ul class="sub-menu">
	<li id="menu-item-259" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-259"><a title="Version français and english version" href="index.html%3Fp=255.html">Licence</a></li>
	<li id="menu-item-288" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-288"><a href="https://github.com/hdsdi3g/MyDMAM" onclick="_gaq.push(['_trackEvent', 'outbound-widget', 'https://github.com/hdsdi3g/MyDMAM', 'GitHub']);" >GitHub</a></li>
	<li id="menu-item-293" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-293"><a href="category/news/changelogs/index.html">Changelogs</a></li>
	<li id="menu-item-226" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-226"><a href="index.html%3Fp=178.html">Development setup</a></li>
	<li id="menu-item-371" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-371"><a href="index.html%3Fp=368.html">Analyse et rendu des Metadatas</a></li>
</ul>
</li>
<li id="menu-item-39" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-39"><a href="index.html%3Fp=30.html">Contact</a>
<ul class="sub-menu">
	<li id="menu-item-48" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-48"><a href="http://hd3g.tv" onclick="_gaq.push(['_trackEvent', 'outbound-widget', 'http://hd3g.tv', 'Author&#8217;s Blog (fr)']);" >Author&#8217;s Blog (fr)</a></li>
	<li id="menu-item-47" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-47"><a href="https://twitter.com/MyDMAM" onclick="_gaq.push(['_trackEvent', 'outbound-widget', 'https://twitter.com/MyDMAM', 'Twitter']);" >Twitter</a></li>
</ul>
</li>
</ul></div>					<form role="search" method="get" class="search-form" action="index.html">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form>				</nav><!-- #site-navigation -->
			</div><!-- #navbar -->
		</header><!-- #masthead -->

		<div id="main" class="site-main">

	<div id="primary" class="content-area">
		<div id="content" class="site-content" role="main">

						
				<article id="post-15" class="post-15 page type-page status-publish hentry">
					<header class="entry-header">
						
						<h1 class="entry-title">Setup</h1>
					</header><!-- .entry-header -->

					<div class="entry-content">
						<blockquote><p>This actual content is actually not up to date. Please check setup functions <a href="https://github.com/hdsdi3g/MyDMAM/tree/startup" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/hdsdi3g/MyDMAM/tree/startup', 'here']);" >here</a> !</p></blockquote>
<p>You will install/configure:</p>
<ul>
<li>An Apache Cassandra node</li>
<li>An ElasticSearch node</li>
<li>Play! Framework <strong>v1.x, not a 2.x version</strong></li>
<li>A complete MyDMAM instance, with a Probe, a Server and CLI.</li>
</ul>
<p>You can download a pack with <em>Play! Framework</em>, <em>mydmam-lib</em> package and <em>mydmam</em> source <a title="Downloads" href="index.html%3Fp=67.html">here</a> !</p>
<p>Read instructions for <a title="Development setup" href="index.html%3Fp=178.html">Development setup</a> if you want to see more.</p>
<h2>Pre-installation</h2>
<p>You need:</p>
<ul>
<li>Linux (any), OSX (10.6 or up to), Windows. In fact, the only limitation is that Java must be installed.</li>
<li>Java 1.6 (or 1.7) up to date. OpenJDK should work but <span style="line-height: 1.5;">not recommended for Cassandra. <strong>Use the same Java version between instances !</strong> This is not obvious if you have mixed Windows/Linux/OSX hosts or setups.<br />
</span></li>
<li>Some RAM and some CPU for execute databases and services. However, if you have small needs or you want just test on one server, it work well on 2 GB free RAM and 2 CPU. But beware, Cassandra and ES eat all the memory you give them (for performance and caching reasons). Do not underestimate this configuration.</li>
<li>Git, tar and gzip. Some basics Linux and shell admin knowledge (if you want setup on Linux or OSX).</li>
<li><span style="line-height: 1.5;"><span style="line-height: 1.5;">We consider Java, Play, MyDMAM and MyDMAM-lib were downloaded and unpackaged/compilated with <a title="Downloads" href="index.html%3Fp=67.html"><strong>pack.sh</strong></a>. <em style="line-height: 1.5;">This example is for Debian 7 with simple base install, but you could adapt it for all OS.</em></span></span></li>
</ul>
<p>Then, install Cassandra and ElasticSearch, in the same host, or separate hosts, in single instances or cluster, for each Db. You can virtualize all, including MyDMAM itself.</p>
<p>Don&#8217;t forget that MyDMAM is a <strong>multi node design</strong> : you&#8217;re not limited by the instance count. The hardware, databases cluster size and needs are your only limits.</p>
<p><a title="Downloads" href="index.html%3Fp=67.html" target="_blank">Download</a> elements.</p>
<h3>JCE issues</h3>
<p>The Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files must installed on your MyDMAM hosts. A test is performed on every launch. If it fails, a message is let in log file, with the action to do. JCE bring strong cryptography, especially for passwords cypher.</p>
<p>Here a example with error message:</p>
<pre>--------~~~~~~===============~~~~~~--------
               Fatal error !
You must to setup Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files

Go to http://www.oracle.com/technetwork/java/javase/downloads/index.html
And download it (it's free and legal)

Unzip, and copy US_export_policy.jar and local_policy.jar to this directory:

 /Library/Java/JavaVirtualMachines/jdk1.7.0_51.jdk/Contents/Home/jre/lib/security/

Overwrite the actual jar files
--------~~~~~~==============~~~~~~--------</pre>
<p>OpenJDK may be not concerned by this problem (but it is not advisable to use with Cassandra and ES).</p>
<h2>Prepare Cassandra</h2>
<p><span style="line-height: 1.5;">Go to Cassandra configuration file and c</span>hange some values:</p>
<pre># The same for all nodes
cluster_name: 'Test Cluster'

# The ideal number of "concurrent_writes" is dependent on the
# number of cores in your system; (8 * number_of_cores)
# is a good rule of thumb.
concurrent_reads: 32
concurrent_writes: 32</pre>
<p>Edit Cassandra env file and c<span style="line-height: 1.5;">hange important values for memory usage and JMX port, set </span><strong style="line-height: 1.5;">MAX_HEAP_SIZE</strong><span style="line-height: 1.5;">, </span><strong style="line-height: 1.5;">HEAP_NEWSIZE</strong><span style="line-height: 1.5;"> and </span><strong style="line-height: 1.5;">JMX_PORT</strong><span style="line-height: 1.5;">. If you let calculate this script, you don&#8217;t will have enough RAM to ElasticSearch and MyDMAM.</span></p>
<pre>#MAX_HEAP_SIZE="4G"
#HEAP_NEWSIZE="800M"
<span style="line-height: 1.5;"># Specifies the default port over which Cassandra will be available
# for</span> JMX connections.
JMX_PORT="7199"</pre>
<p>And restart it.</p>
<p>It&#8217;s ok if it show &#8220;<strong>Listening for thrift clients&#8230;</strong>&#8221; at the end. Close it with CTRL+C</p>
<p><em>Thrift</em> is the server for communicate with a Cassandra node.</p>
<h2><span style="font-family: Bitter, Georgia, serif; font-size: 30px; line-height: 1.3;">Prepare ElasticSearch</span></h2>
<p><span style="line-height: 1.5;">Install <strong>head</strong> plugin (web interface to navigate in ElasticSearch database) with: </span></p>
<pre><span style="line-height: 1.5;">&lt;</span><span style="line-height: 1.5;">ElasticSearch setup&gt;/bin/plugin --install mobz/elasticsearch-head</span></pre>
<p>To use it, go to <em>http://elasticsearchserver:9200/_plugin/head/</em></p>
<h2>Prepare Play</h2>
<p>Play is just a framework ; MyDMAM configuration and startup files will configure it on demand.</p>
<h2><span style="font-family: Bitter, Georgia, serif; font-size: 30px; line-height: 1.3;">Prepare MyDMAM</span></h2>
<h3>Startup scripts</h3>
<p><em>This is the painful part.</em></p>
<p>For Debian, move/link startup scripts from <strong>mydmam-statup</strong> directory :</p>
<pre>mydmam-default.sh -&gt; /etc/default/mydmam
mydmam-probe-default.sh -&gt; /etc/default/mydmam-probe
mydmam-probe-service.sh -&gt; /etc/init.d/mydmam-probe
mydmam-server-default.sh -&gt; /etc/default/mydmam-server
mydmam-server-service.sh -&gt; /etc/init.d/mydmam-server

chmod +x /etc/init.d/mydmam-server
chmod +x /etc/init.d/mydmam-probe

update-rc.d mydmam-server defaults
update-rc.d mydmam-probe defaults

mydmam-cli.sh -&gt; /usr/bin/mydmam-cli # MyDMAM CLI interface
chmod +x /usr/bin/mydmam-cli</pre>
<p>Adapt <strong>default</strong> configurations files.</p>
<p>Log directory, user and group will be created by <strong>init.d</strong> script.</p>
<p><span style="line-height: 1.5;">For Windows and OSX, </span>startup elements will be add.<span style="line-height: 1.5;"> For other Linux distributions, adapt Debian startup scripts (and share it!).</span></p>
<p><span style="line-height: 1.5; font-family: Bitter, Georgia, serif; font-size: 22px;">Configure</span></p>
<p>Go to mydmam main directory, to conf/app.d. By default, this folder contains the active configuration. Edit all:</p>
<h4>cassandra.yml</h4>
<pre>cassandra:
  apply: prod                # Ignore it you don't do development.
  clustername : mycluster    # The same value on Cassandra's configuration cluster_name key
  rpc_address : 192.168.0.1  # Cassandra server's IP (Thrift server)
  rpc_port : 9160            # Cassandra server's port (Thrift server)
  maxconnsperhosts : 10
  keyspace : wfprod          # Cassandra keyspace's for create or use.</pre>
<h4>elasticsearch.yml</h4>
<pre>elasticsearch:
    apply: prod                     # Ignore it you don't do development.
    clustername : escluster         # The same value on ElasticSearch's configuration cluser.name key
    transport_address : 192.168.0.1 # ElasticSearch http server
    transport_port : 9300           # ElasticSearch http port</pre>
<h4>play.yml</h4>
<pre>play:
    deploy: /opt/play  # Just the Play directory</pre>
<h4>service.yml</h4>
<p>The most interesting.</p>
<pre>service:
    apply: prod
    workername : productionsrv     # Must be different between each Probe instance. 
    brokercleantasks : true        # Only one by host (if an host has more than one Probe).

javamail:
    from: Me &lt;me@domain.com&gt;       # Sender mail
    to: admin@domain.com           # Recipient mail
    server: exchange.domain.com    # A SMTP server for this recipient mail
    debug: false                   # Set true for debugging mail sending problems.

log2:
    [...]
    rotate_file: /var/log/mydmam/server.log # Set a valid directory and different files by instance. If you start Probe and Server with the same Yaml directory, Probe and Server will log in the same file. It's not a problem, but you need to know.
    rotate_maxsize: 1000000                 # Internal rotate engine for MyDMAM, 1MB max by file
    rotate_maxfilelogs: 10                  # 10 log files
service:                           # Ignore it</pre>
<h2>Start MyDMAM server</h2>
<p>In case of problems with configuration syntax, add</p>
<pre>-Dservice.config.verboseload=true</pre>
<p>In mydmam <em>default</em> configuration file, in <strong>APP_PROPERTIES</strong> variable; Yaml files are sensitive for spaces (don&#8217;t use TAB).</p>
<p>So</p>
<pre>/etc/init.d/mydmam-server start  # Debian style</pre>
<p>And go to logs for see what&#8217;s append.</p>
<p>Go to <span style="text-decoration: underline;">http://mydmam-server:9001/</span> for web interface. The first web page launch after start take time (10 sec. max), because Play must load a lot of lib and check/compile all the code. After, it&#8217;s really fast.</p>
<p>If you check process list, you can see 3 elements:</p>
<p>MyDMAM Web server, the starter for Play.</p>
<pre>mydmam 1303 0.2 10.2 357432 52272 ? Sl 18:29 0:08 /usr/bin/java -Dfile.encoding=UTF-8 -Dservice.config.apply=prod -Dservice.config.path=/opt/mydmam/conf/app.d -Dlog2.fi...</pre>
<p>The Play starter in Python (original and embeded in Play! directory).</p>
<pre>mydmam 1333 0.0 2.2 43832 11312 ? S 18:29 0:00 python /opt/play-1.2.7/play run /opt/mydmam --silent -Dservice.config.path=/opt/mydmam/conf/app.d -Dservice.config.app...</pre>
<p>The <em>real</em> Play process.</p>
<pre>mydmam 1337 1.3 41.8 664504 213204 ? Sl 18:29 0:48 java -javaagent:/opt/play-1.2.7/framework/play-1.2.7.jar -Dservice.config.path=/opt/mydmam/conf/app.d -Dservice.config...</pre>
<h2><span style="line-height: 1.5;">Start probe</span></h2>
<pre>/etc/init.d/mydmam-probe start  # Debian style</pre>
<p>And go to logs for see what&#8217;s append. For this configuration, it&#8217;s the same log file as server.</p>
<p>This error are normal, we don&#8217;t add storage configuration:</p>
<pre>2014/01/18 15:31:06,153 ERROR StorageManager "Can't load storage configuration" Service,13
 at hd3gtv.storage.StorageManager.getGlobalStorage(StorageManager.java:50)
  java.lang.NullPointerException: No Storage configuration
    at hd3gtv.storage.StorageManager.&lt;init&gt;(StorageManager.java:58)
    at hd3gtv.storage.StorageManager.refreshGlobalStorage(StorageManager.java:41)
    at hd3gtv.storage.StorageManager.getGlobalStorage(StorageManager.java:47)
    at hd3gtv.mydmam.probe.MyDMAMProbeService.startApplicationService(MyDMAMProbeService.java:68)
    at hd3gtv.javasimpleservice.ServiceManager$ServiceThread.run(ServiceManager.java:223)</pre>
<p><span style="line-height: 1.5;">Actually, the application do&#8230; nothing.</span></p>
<p>To see its presence, go to web interface, to <strong>Admin</strong> menu, <strong>Services status</strong> page.</p>
<p>To hide Broker Queue clean operation log entries, like</p>
<pre>2014/01/18 15:17:48,672 DEBUG BrokerQueue "Broker clean operation" Queue,22
 at hd3gtv.mydmam.taskqueue.BrokerQueue.run(BrokerQueue.java:237)</pre>
<p>Add this in <strong>mydmam/conf/app.d/service.yml</strong>, section <em>log2</em>, <em>filter:</em></p>
<pre>        -
            for: hd3gtv.mydmam.taskqueue.BrokerQueue.run
            level: DEBUG
            type: HIDE</pre>
<p>Respect spaces !</p>
<h2>Use CLI</h2>
<p>Just do, if CLI is on your PATH:</p>
<pre>mydmam-cli</pre>
<p><span style="line-height: 1.5;">Don&#8217;t be afraid with log messages. They are redirected to the standard output.</span></p>
<p>Use embedded documentation.</p>
<h2>Update</h2>
<h3>MyDMAM</h3>
<p>The master branch in GitHub repositiory are always stable and previously tested. But, <a href="https://github.com/hdsdi3g/MyDMAM/releases" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/hdsdi3g/MyDMAM/releases', 'check the notes versions']);" target="_blank">check the notes versions</a> for verify the compatibility with your actual configuration, modules, databases versions and structures, engines, external jars&#8230;</p>
<p>Normally, you haven&#8217;t not to update all instances at the same time; you can update host after host.</p>
<p>So, to update MyDMAM source:</p>
<pre>cd /opt/mydmam # your MyDMAM directory
git pull origin master
/etc/init.d/mydmam-server precompile # A startup script (here for Debian, you can use mydmam-probe) for call Play! precompile function
/etc/init.d/mydmam-server restart
/etc/init.d/mydmam-probe restart</pre>
<p>And check your mails, and log file to see potential problems.</p>
<h3>Databases</h3>
<p>Never update databases if MyDMAM is not prepared for !</p>
<p>Cassandra need an <a href="https://github.com/Netflix/astyanax/wiki/Cassandra-compatibility" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/Netflix/astyanax/wiki/Cassandra-compatibility', 'Astyanax compatible version']);" target="_blank">Astyanax compatible version</a>, and MyDMAM must check if recent Astyanax version is compatible with it (maybe update Astyanax jars).</p>
<p>Elasticsearch needs the new version jars are the same in MyDMAM lib directory. So, copy their from ES lib directory to MyDMAM lib directory.</p>
<h3>Frameworks/API</h3>
<p>Play! version 1 are not in active development, just correct <strong>security problems</strong>. So <strong>do all minor updates for version 1 family</strong>: just do it on all MyDMAM instances (overwrite files, change paths in default scripts, and restart instances).</p>
<p>If you have time to spare, you can update the jars in the lib folder. These are the standard versions compiled without special modifications. There is a high risk of incompatibility between these new jars, MyDMAM and the others MyDMAM jars. So <strong>do it only if a MyDMAM update requests it</strong>. And do the same everywhere.</p>
<h3>Engines</h3>
<p>Updating ffmpeg or ImageMagick is dangerous because if MyDMAM call it with an bad (old) argument, you will enjoy some <em>cool and terrible problems</em>. Else, there are no problems for update.</p>
<h3>Java</h3>
<p>If you want update Java, it&#8217;s ok. But, do it on all servers (databases and MyDMAM instances), and at the same time for ElasticSearch (mixed various Java versions between ES server and ES jars in MyDMAM are fatal).<br />
So, if you want update Java, plan a full cluster and service stop, and plan to do it everywhere.</p>
											</div><!-- .entry-content -->

					<footer class="entry-meta">
											</footer><!-- .entry-meta -->
				</article><!-- #post -->

				
<div id="comments" class="comments-area">

	
	
</div><!-- #comments -->			
		</div><!-- #content -->
	</div><!-- #primary -->


		</div><!-- #main -->
		<footer id="colophon" class="site-footer" role="contentinfo">
				<div id="secondary" class="sidebar-container" role="complementary">
		<div class="widget-area">
			<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="index.html">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside>		<aside id="recent-posts-3" class="widget widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
					<li>
				<a href="index.html%3Fp=466.html">Git master branch update v0.16</a>
						</li>
					<li>
				<a href="index.html%3Fp=462.html">Git master branch update v0.15</a>
						</li>
					<li>
				<a href="index.html%3Fp=456.html">Git master branch update v0.14</a>
						</li>
					<li>
				<a href="index.html%3Fp=442.html">MyDMAM a 3 ans</a>
						</li>
					<li>
				<a href="index.html%3Fp=419.html">Elasticsearch v2 is here !</a>
						</li>
				</ul>
		</aside>		<aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='2016/04/index.html'>April 2016</a></li>
	<li><a href='2016/03/index.html'>March 2016</a></li>
	<li><a href='2015/12/index.html'>December 2015</a></li>
	<li><a href='2015/10/index.html'>October 2015</a></li>
	<li><a href='2015/05/index.html'>May 2015</a></li>
	<li><a href='2015/04/index.html'>April 2015</a></li>
	<li><a href='2015/03/index.html'>March 2015</a></li>
	<li><a href='2015/02/index.html'>February 2015</a></li>
	<li><a href='2015/01/index.html'>January 2015</a></li>
	<li><a href='2014/12/index.html'>December 2014</a></li>
	<li><a href='2014/09/index.html'>September 2014</a></li>
	<li><a href='2014/08/index.html'>August 2014</a></li>
	<li><a href='2014/07/index.html'>July 2014</a></li>
	<li><a href='2014/06/index.html'>June 2014</a></li>
	<li><a href='2014/05/index.html'>May 2014</a></li>
		</ul>
		</aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-15"><a href="category/news/changelogs/index.html" title="Git changelogs">Changelogs</a>
</li>
	<li class="cat-item cat-item-30"><a href="category/news/index.html" title="Projet news and general announcements.">News</a>
</li>
		</ul>
</aside><aside id="wpt-latest-tweets-2" class="widget wpt-latest-tweets"><div class="wpt-header"><div class='wpt-follow-button'><a href='https://twitter.com/mydmam' class='twitter-follow-button wpt-right' data-width='30px' data-show-screen-name='false' data-size='large' data-show-count='false' data-lang='en'>Follow @mydmam</a></div>
		</p>
		<img src='https://pbs.twimg.com/profile_images/427239272941244418/jcR8fe0F_normal.png' alt='' class='wpt-twitter-avatar wpt-left ' />
		<span class='wpt-twitter-name'>MyDMAM Project</span><br />
		<span class='wpt-twitter-id'><a href='https://twitter.com/mydmam'>@mydmam</a></span>
		</p></div><ul>
<li class="lang-en">Site: Git master branch update v0.16 https://t.co/DfDek7rUq1<br /><span class='wpt-tweet-time'><a href="http://twitter.com/mydmam/status/726058932171591680">about 2 weeks ago</a></span>  </li>
<li class="lang-en">Site: Git master branch update v0.15 https://t.co/iS4Y42V6OD<br /><span class='wpt-tweet-time'><a href="http://twitter.com/mydmam/status/719615908847689728">about 1 month ago</a></span>  </li>
<li class="lang-en">Correct documentation for Play + Apache &amp; reverse-proxy https://t.co/XXf4hBxadV (correct https://t.co/ni2SPuznLl)<br /><span class='wpt-tweet-time'><a href="http://twitter.com/mydmam/status/710848907362897921">about 2 months ago</a></span>  </li>
<li class="lang-fr">Autour de MyDMAM : développer un logiciel libre - https://t.co/Li0G6MRpDx<br /><span class='wpt-tweet-time'><a href="http://twitter.com/mydmam/status/710219038182547457">about 2 months ago</a></span>  </li>
<li class="lang-en">Site: Git master branch update v0.14 https://t.co/oowLzBX17z<br /><span class='wpt-tweet-time'><a href="http://twitter.com/mydmam/status/706247333609132032">about 2 months ago</a></span>  </li>
</ul>
</aside>		</div><!-- .widget-area -->
	</div><!-- #secondary -->

			<div class="site-info">
&copy; mydmam.org / hd3g.tv 2013 &bull;
Licenced under the <a rel="external" href="http://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA 3.0 Unported</a> and <a rel="external" href="http://www.gnu.org/copyleft/fdl.html">GFDL</a>.
<br>
Site powered by <a rel="external" href="http://wordpress.org">WordPress</a>, dressed with Twenty Thirteen, hosted at <a rel="external" href="http://www.ovh.com/">OVH</a>.
				<!-- 				<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a> -->
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->

	<a class = "github-ribbon" href="https://github.com/hdsdi3g/MyDMAM" target = "_blank" ><img style="position: fixed; top: 0; right: 0; border: 0;z-index:100000" src="http://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub" /></a><script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201620'></script>
<script type="text/javascript" src="wp-content/cache/minify/000000/M9HPTSzOzyuq1MvNzNMx1s8qLE0FcZAEDfRzK1NyE3P1s4r100rzkksy8_OKdUz0ywt0U3OTUlNAigA.js"></script>
<script type='text/javascript' src='https://platform.twitter.com/widgets.js?ver=be63b55bd13097cdf910707a9a52c072'></script>
<script type='text/javascript' src='http://stats.wp.com/e-201620.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:4.0.2',blog:'104858173',post:'15',tz:'2',srv:'mydmam.org'} ]);
	_stq.push([ 'clickTrackerInit', '104858173', '15' ]);
</script>

			<div id="cookie-notice" class="cn-top wp-default" style="color: #fff; background-color: #000;"><div class="cookie-notice-container"><span id="cn-notice-text">This site use cookies to ensure that we give you the best experience on our website. If you continue to use this site we will assume that you are happy with it.</span><a href="index.html%3Fp=15.html#" id="cn-accept-cookie" data-cookie-set="accept" class="cn-set-cookie button wp-default">Ok</a>
				</div>
			</div></body>
</html>
<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Minified using disk
Page Caching using disk: enhanced
Database Caching 9/16 queries in 0.006 seconds using disk
Object Caching 1322/1342 objects using disk

 Served from: mydmam.org @ 2016-05-16 12:27:24 by W3 Total Cache -->