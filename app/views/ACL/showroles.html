*{
 * This file is part of MyDMAM.
 * 
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 * 
 * Copyright (C) hdsdi3g for hd3g.tv 2014
 * 
}*
#{extends 'ACL/grid.html' /}

<p>
	<a href="@{ACL.addrole()}" class="btn btn-success"><i class="icon-plus icon-white"></i> &{'acl.add'}</a> 
</p>

<table class="table table-striped table-hover table-condensed elementlist">
    <thead>
        <tr>
            <th>Nom</th>
            <th>Groupes</th>
            <th>Privileges</th>
            <th>
            	<input type="checkbox" id="btn-toogle-desactivate" ckecked="checked" style="margin-left:39px;" />
            </th>
		</tr>
    </thead>
    <tbody>
    #{list items:roles, as:'element'}
		<tr>
			<td>${element.name}</td>
			<td>
				#{if element.groups}
				<div class="dropdown">
					<button id="dusr-${element.name.makeUniqId()}" class="dropdown-toggle btn btn-mini" role="button" data-toggle="dropdown">
						${element.groups.size()}
						<b class="caret"></b>
					</button>
					<ul class="dropdown-menu" role="menu" aria-labelledby="dusr-${element.name.makeUniqId()}">
	    				#{list items:element.groups, as:'group'}
							<li>
								<a href="@{ACL.editgroup(group.name)}">
									${group.name} (${group.users.size()})
								</a>
							</li>
						#{/list}
					</ul>
				</div>
				#{/if}#{else}
					<em>Pas de groupes associés.</em>
				#{/else}
			</td>
			<td>
				#{if element.privileges}
    				#{list items:element.privileges, as:'privilege'}
    					${privilege.fromCamelCaseToSpaces()}<br>
					#{/list}
				#{/if}#{else}
					<em>Pas de privileges ajoutés.</em>
				#{/else}
			</td>
			<td>
				<a href="@{ACL.editrole(element.name)}" class="btn btn-mini btn-info"><i class="icon-pencil icon-white"></i></a>
				#{if element.groups.size() == 0}
					<a href="@{ACL.deleterole(element.name)}" class="btn btn-mini btn-danger btn-toogle-desactivate disabled"><i class="icon-trash icon-white"></i></a>
				#{/if}
			</td>
		</tr>
    #{/list}
    </tbody>
</table>


<script type="text/javascript" charset="UTF-8">
<!--
$(document).ready(function() {
   	try {
		$("#btnAdmin").addClass("active");
		$("#subMenuBtnRole").addClass("active");
		
		$('#btn-toogle-desactivate').click(function (){
			$(".btn-toogle-desactivate").toggleClass("disabled");
		});
	
		$('.btn-toogle-desactivate').click(function (){
			return $(this).hasClass("disabled") == false;
		});
		
		if ($(".btn-toogle-desactivate").length == 0) {
			$("#btn-toogle-desactivate").remove();
		}
		
		$('.elementlist').dataTable({
			"bPaginate": false,
		    "bLengthChange": false,
		    "bSort": true,
		    "bInfo": false,
		    "bAutoWidth": false,
		    "bFilter": true,
		    "aoColumnDefs": [
				{"bVisible": true, "bSearchable": true, "bSortable": false, "aTargets": [2]},
				{"bVisible": true, "bSearchable": false, "bSortable": false, "aTargets": [3]},
			]
		});

		$('#sitesearch').bind('keyup.DT', function(e) {
			var val = this.value==="" ? "" : this.value;
			$('.dataTables_filter input').val(val);
			$('.dataTables_filter input').trigger("keyup.DT");
		});
		
	} catch(err) {
		console.log(err);
	}
});
-->
</script>
