*{
 * This file is part of MyDMAM.
 * 
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 * 
 * Copyright (C) hdsdi3g for hd3g.tv 2012-2014
 * 
}*<!DOCTYPE html>
<html lang="en">
<head>
	<title>
		%{ if (flash.pagename != null) {
				if (flash.pagename.equals("null") == false) {
					out.println(flash.pagename + " ::");
				}
			} }%
		&{'site.name'}
	</title>
	<meta charset="UTF-8">
	<!-- meta name="viewport" content="width=device-width, initial-scale=1.0" -->
	<link rel="stylesheet" media="all" href="@{'/public/stylesheets/bootstrap.min.css'}">
	<link rel="stylesheet" media="all" href="@{'/public/stylesheets/bootstrap-responsive.min.css'}">
	<link rel="stylesheet" media="all" href="@{'/public/stylesheets/jquery.dataTables.css'}">
	<link rel="stylesheet" media="all" href="@{'/public/stylesheets/selectize-0.11.2.css'}">
	<link rel="stylesheet" media="all" href="@{'/public/stylesheets/selectize.bootstrap2-0.11.2.css'}">
	<link rel="stylesheet" media="all" href="@{'/public/stylesheets/style.css'}">
	#{get 'moreStyles' /}
	
	<link rel="shortcut icon" href="@{'/public/img/favicon.ico'}">
	<link rel="apple-touch-icon" href="@{'/public/img/apple-touch-icon.png'}" />
	
	<script src="@{'/public/javascripts/lib/jquery-1.10.2.min.js'}" type="text/javascript" charset="UTF-8"></script>
	<script src="@{'/public/javascripts/lib/bootstrap.min.js'}" type="text/javascript" charset="UTF-8"></script>
	<script src="@{'/public/javascripts/lib/md5.min.js'}" type="text/javascript" charset="UTF-8"></script>
	<script src="@{'/public/javascripts/lib/jquery.dataTables.min.js'}" type="text/javascript" charset="UTF-8"></script>
	<script src="@{'/public/javascripts/lib/selectize-0.11.2.min.js'}" type="text/javascript" charset="UTF-8"></script>
	<script src="@{'/public/javascripts/lib/react-0.13.2.min.js'}" type="text/javascript" charset="UTF-8"></script>
	<script src="@{'/public/javascripts/lib/rlite-1.1.1.min.js'}" type="text/javascript" charset="UTF-8"></script>
	
	<script type="text/javascript" charset="UTF-8"><!-- #{include 'routes.js'/} --></script>
	
	#{list hd3gtv.mydmam.web.JSSourceManager.getURLs(), as:'item'}
		<script src="&{item}" type="text/javascript" charset="UTF-8"></script>
	#{/list}
	
	<script src="@{Application.i18n()}" type="text/javascript" charset="UTF-8"></script>
	
	#{get 'moreScripts' /}
</head>

<body>

<script type="text/javascript" charset="UTF-8">
var jsx_error_messages = [];

<!--
$(document).ready(function() {
	$(function () {
        $('body').popover({
            selector: '[data-toggle="popover"]'
        });

        $('body').tooltip({
            selector: 'a[rel="tooltip"], [data-toggle="tooltip"]'
        });
        
        %{ String background = hd3gtv.configuration.Configuration.global.getValue("play", "background", "");
        	if (background.equals("") == false) {
				out.println("\$('body').css('background', \"url('" + background + "') no-repeat center top\");");
				out.println("\$('body').css('background-size', '100%');");
				out.println("\$('body').css('background-color', '#e5e4e4');");
				out.println("\$('.hero-unit').css('background-color', 'rgba(238, 238, 238, 0.4)');");
			} }%
		
		$('.checkifempty').each(function() {
			var checkthis = $(this).data("deleteifempty");
			if ($("#" + checkthis).children().length == 0) {
				$(this).remove();
			}
		});
		
		if (jsx_error_messages.length > 0) {
			for (pos = 0; pos < jsx_error_messages.length; pos++) {
				console.log("Error in " + jsx_error_messages[pos].from + "\n\n" + jsx_error_messages[pos].text + "\n\n" + jsx_error_messages[pos].line);
			}
		}
    });
});
-->
</script>

<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container-fluid">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="@{Application.index()}">&{'maingrid.brand'}</a>
 
 		<ul class="nav pull-right">
			#{secure.check 'navigate'}
		 		<li>
			 		#{form @Application.search(), class:'navbar-search', method:'GET'}
				  		<input type="text" id="sitesearch" class="search-query span2" placeholder="&{'maingrid.search'}" name="q" />
				  		<input type="hidden" name="from" value="1"/>
					#{/form}
		 		</li>
				<li class="divider-vertical"></li>
			#{/secure.check}
					
			<li class="dropdown" id="btnSession">
				<a class="dropdown-toggle" data-toggle="dropdown" href="#">
					%{ out.println(session.get('longname')) }%
					<b class="caret"></b>
				</a>
				<ul class="dropdown-menu">
					<li>
						<a href="@{User.index()}"><i class="icon-wrench"></i> &{'userprofile.usereditor.pagename'}</a>
					</li>
					#{secure.check 'navigate'}
						<li>
							<a href="@{UserBasket.baskets()}"><i class="icon-shopping-cart"></i> &{'userprofile.baskets.pagename'}</a>
						</li>
					#{/secure.check}
					<li>
						<a href="@{UserNotifications.notificationslist()}"><i class="icon-bell"></i> &{'userprofile.notifications.pagename'}</a>
					</li>
					<li>
						<a href="@{Secure.logout()}"><i class="icon-off"></i> &{'maingrid.disconnect'}</a>
					</li>
				</ul>
			</li>
 		</ul>

      <!-- Everything you want hidden at 940px or less, place within here -->
      <div class="nav-collapse collapse">
 		<ul class="nav pull-left navbar-fixed-top-btn">
			#{secure.check 'navigate'}
				<li id="btnStorage">
					<a href="@{Application.navigate()}">&{'application.navigate'}</a>
				</li>
			#{/secure.check}
			
			%{	menu_elements = hd3gtv.mydmam.module.MyDMAMModulesManager.getAllUserMenusEntries()
				menu_elements.each() { if (controllers.Secure.checkview(it.privilege)) {
			}%
				#{if it.add_divider}
					<li class="divider-vertical"></li>
				#{/if}
			<li id="&{it.btn_id}" #{if it.subitems}class="dropdown"#{/if}>
				<a href="&{it.getPlayTargetUrl()}" #{if it.subitems}class="dropdown-toggle" data-toggle="dropdown"#{/if}>
					&{it.title}
					#{if it.subitems}<b class="caret"></b>#{/if}
				</a>
				#{if it.subitems}
					<ul class="dropdown-menu">
						%{	
							it.subitems.eachWithIndex() { item, p ->
						}%
							<li id="&{item.btn_id}">
								<a href="&{item.getPlayTargetUrl()}">&{item.title}</a>
								#{if item.add_divider}
									<li class="divider"></li>
								#{/if}
							</li>
						%{
							}
						}%
					</ul>
				#{/if}
			</li>
			%{
				} }
			}%
			
			<li class="divider-vertical checkifempty" data-deleteifempty="mainadminmenu"></li>
			
			<li class="dropdown checkifempty" id="btnAdmin" data-deleteifempty="mainadminmenu">
				<a class="dropdown-toggle" data-toggle="dropdown" href="#">
					&{'maingrid.adminbtn'}
					<b class="caret"></b>
				</a>
				<ul class="dropdown-menu" id="mainadminmenu">
					%{	adminmenu_elements = hd3gtv.mydmam.module.MyDMAMModulesManager.getAllAdminMenusEntries()
						adminmenu_elements.eachWithIndex() { adminitem, p ->
						if (controllers.Secure.checkview(adminitem.privilege)) {
					}%
						<li id="&{adminitem.btn_id}" #{if adminitem.subitems}class="dropdown-submenu"#{/if}>
							<a href="&{adminitem.getPlayTargetUrl()}" #{if adminitem.subitems}tabindex="-1"#{/if}>&{adminitem.title}</a>
							#{if adminitem.subitems}
								<ul class="dropdown-menu">
								%{	
									adminitem.subitems.eachWithIndex() { sitem, i ->
									if (controllers.Secure.checkview(sitem.privilege)) {
								}%
									<li id="&{sitem.btn_id}">
										<a href="&{sitem.getPlayTargetUrl()}">&{sitem.title}</a>
									</li>
									#{if sitem.add_divider}
										<li class="divider"></li>
									#{/if}
								%{
									}}
								}%
								</ul>
							#{/if}
							#{if adminitem.add_divider}
								<li class="divider"></li>
							#{/if}
						</li>
					%{
						}}
					}%
					
					#{secure.check 'adminUsers'}
						<li>
							<a href="@{UserBasket.basketsadmin}"><i class="icon-shopping-cart"></i> &{'userprofile.baskets.admin.pagename'}</a>
						</li>
						<li>
							<a href="@{UserNotifications.notificationsadminlist}"><i class="icon-bell"></i> &{'userprofile.notifications.admin.pagename'}</a>
						</li>
					#{/secure.check}
					
					#{secure.check 'showJobs'}
						<li class="divider"></li>
						<li class="nav-header">
							&{'service.menuinfrastructure'}
						</li>
						<li>
							<a href="@{Application.indexjs()}#watchfolders"><i class="icon-folder-open"></i> &{'manager.watchfolders.pagename'}</a>
						</li>
						<li>
							<a href="@{Application.indexjs()}#broker"><i class="icon-tasks"></i> &{'manager.jobs.pagename'}</a>
						</li>
					#{/secure.check}

					#{secure.check 'showManager'}
						<li>
							<a href="@{Manager.index()}"><i class="icon-hdd"></i> &{'manager.pagename'}</a>
						</li>
						<li>
							<a href="@{Manager.clusterstatus()}"><i class="icon-globe"></i> &{'service.clusterstatus.report.pagename'}</a>
						</li>
						<li>
							<a href="@{Manager.playjobs()}"><i class="icon-info-sign"></i> &{'service.playjobs.pagename'}</a>
						</li>
					#{/secure.check}

					#{secure.check 'ftpServer'}
						<li>
							<a href="@{Application.indexjs()}#ftpserver"><i class="icon-random"></i> &{'ftpserver.pagename'}</a>
						</li>
					#{/secure.check}
					
					#{secure.check 'acl'}
						<li class="divider"></li>
						<li class="nav-header">
							&{'acl.pagenamelight'}
						</li>
						<li>
							<a href="@{ACL.showusers()}"><i class="icon-user"></i> &{'acl.pagename.users'}</a>
						</li>
						<li>
							<a href="@{ACL.showgroups()}"><i class="icon-user"></i> &{'acl.pagename.groups'}</a>
						</li>
						<li>
							<a href="@{ACL.showroles()}"><i class="icon-user"></i> &{'acl.pagename.roles'}</a>
						</li>
						<li>
							<a href="@{ACL.showblacklistips()}"><i class="icon-user"></i> &{'acl.pagename.showblacklistips'}</a>
						</li>
					#{/secure.check}
					
					#{secure.check 'adminCrud'}
						<li>
							<a href="@{Admin.index(objtype:'userprofile')}"><i class="icon-th-list"></i> &{'crud.field.userprofile'}</a>
						</li>
					#{/secure.check}
					
				</ul>
			</li>
		</ul>
      </div>
 
    </div>
  </div>  
</div>

<div class="container-fluid">#{doLayout /}</div>
<div class="container-fluid" style="text-align:center; margin-top: 2em;">
	<small class="muted"><a href="http://mydmam.org" style="color: #999999;">MyDMAM</a> &{'site.aboutfooter'}</small>
</div>

#{secure.check 'demoAsync2'}
<!-- div id="example"></div-->
#{/secure.check}

</body>
</html>
