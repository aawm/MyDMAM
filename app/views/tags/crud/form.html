#{list items:_fields, as:'field'}

    %{
        am = ''
		currentObject = _object
    }%

#{if (((field.readonly) & (currentObject != null)) | (field.readonly == false))}

        #{ifnot field}
            %{ throw new play.exceptions.TagInternalException('Field not found -> ' + fieldName) }%
	    #{/ifnot}

        %{ if (field.type == 'method') continue; }%

        #{if field.readonly}
			<div class="control-group">
	       	#{if currentObject}
		        #{if field.type != 'password'}
					<label class="control-label">
				        ${field.name}
				    </label>
				    <div class="controls" style="padding-top: 5px;">
	    	        #{if field.type == 'date'}
					    ${ext.MydmamExtensions.formatDate(currentObject[field.name])}
			        #{/if}
			        #{else}
	        	        #{if field.type == 'boolean'}
			 	        	#{if currentObject[field.name]}
				 	        	&{'crud.' + _type + '.' + field.name + '.true'}
					        #{/if}#{else}
				 	        	&{'crud.' + _type + '.' + field.name + '.false'}
					        #{/else}
				        #{/if}#{else}
							${currentObject[field.name]?.escape()?.raw()}
						#{/else}
			        #{/else}
			        </div>
				#{/if}
	        #{/if}
        #{/if}
        #{else}
	        #{if play.data.validation.Validation.error('object.' + field.name)}
				<div class="control-group error">
	        #{/if}
	        #{else}
				<div class="control-group">
    	    #{/else}
    	    
    	    
	        #{if field.type != 'boolean'}
				<label class="control-label" for="object.${field.name}">&{field.name}</label>
    	    #{/if}
			<div class="controls">

	        #{if field.type == 'text'}
				#{crud.textField name:field.name, value:(currentObject ? currentObject[field.name] : null) /}
	        #{/if}
	
	        #{if field.type == 'password'}
	            #{crud.passwordField name:field.name, value:(currentObject ? currentObject[field.name] : null) /}
	        #{/if}
	
			#{if field.type == 'email'}
	            #{crud.emailField name:field.name, value:(currentObject ? currentObject[field.name] : null) /}
	        #{/if}
	
	        #{if field.type == 'longtext'}
	            #{crud.longtextField name:field.name, value:(currentObject ? currentObject[field.name] : null) /}
	        #{/if}
	
	        #{if field.type == 'number'}
	            #{crud.numberField name:field.name, value:(currentObject ? currentObject[field.name] : null) /}
	            %{ am = 'crud.help.numeric' }%
	        #{/if}
	
	        #{if field.type == 'date'}
	            #{crud.dateField name:field.name, value:(currentObject ? currentObject[field.name] : null) /}
	            %{ am = messages.get('crud.help.dateformat',play.libs.I18N.getDateFormat()) }%
	        #{/if}
	
	        #{if field.type == 'boolean'}
		        <label class="checkbox">
					#{crud.checkField name:field.name, value:(currentObject ? currentObject[field.name] : null) /}
					&{field.name}
				</label>
	        #{/if}
	
	        #{if field.type == 'enum'}
	            #{crud.enumField name:field.name, value:(currentObject ? currentObject[field.name] : null), property:field /}
	        #{/if}

	        #{if field.type == 'pointer'}
	            #{crud.pointersimpleselect name:field.name, value:(currentObject ? currentObject[field.name] : null), property:_fieldspointers.get(field.class_referer) /}
	        #{/if}

	        #{if field.type == 'pointerlist'}
	            #{crud.pointerlist name:field.name, value:(currentObject ? currentObject[field.name] : null), property:_fieldspointers.get(field.class_referer) /}
	        #{/if}
	        
		    <span class="help-inline">
		        &{am}
		            %{ play.data.validation.Validation.getValidators(entityclass, fieldName, 'object').each() { }%
		                %{
		                    switch (it.annotation.annotationType().name.substring(21)) {
		                        case "Required":
		                            out.println(messages.get('crud.help.required'))
		                            break;
		                        case "MinSize":
		                            out.println(messages.get('crud.help.minlength', it.annotation.value()))
		                            break;    
		                        case "MaxSize":
		                            out.println(messages.get('crud.help.maxlength', it.annotation.value()))
		                            break;
		                        case "Range":
		                            out.println(messages.get('crud.help.range', it.annotation.min(), it.annotation.max()))
		                            break;
		                        case "Min":
		                            out.println(messages.get('crud.help.min', it.annotation.value()))
		                            break;
		                        case "Email":
		                            out.println(messages.get('crud.help.email'))
		                            break;
		                        case "Equals":
		                            out.println(messages.get('crud.help.equals', it.params.equalsTo))
		                            break;
		                        case "Future":
		                            if(it.params.reference) {
		                                out.println(messages.get('crud.help.after', it.params.reference))
		                            } else {
		                                out.println(messages.get('crud.help.future'))
		                            }
		                            break;
		                        case "Past":
		                            if(it.params.reference) {
		                                out.println(messages.get('crud.help.before', it.params.reference))
		                            } else {
		                                out.println(messages.get('crud.help.past'))
		                            }
		                            break;
		                    }
		                }%
		            %{ } }%
		    </span>
		    
		    #{if play.data.validation.Validation.error('object.' + field.name)}
		        <span class="help-block"><span class="text-error">%{out.println(messages.get(play.data.validation.Validation.error('object.' + field.name)))}%</span></span>
		    #{/if}
		</div>
    	#{/else}
</div>
#{/if}

#{/list}
