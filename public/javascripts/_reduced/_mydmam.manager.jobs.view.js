(function(a){a.displayClassName=function(b){if(!b){return"";}if(b===""){return"";
}var c=b.substring(b.lastIndexOf(".")+1,b.length);if(b.indexOf("(")>-1){c=b.substring(b.indexOf("(")+1,(b.indexOf(")")));
if(c.indexOf(".java")>-1){c=c.substring(0,c.indexOf(".java"));}}return'<i class="icon-book"></i> <abbr title="'+b+'">'+c+"</abbr>";
};})(window.mydmam.manager.jobs.view);(function(a){a.displayKey=function(b,d){if(!b){return"";
}var c=b.substring(b.lastIndexOf(":")+1,b.lastIndexOf(":")+9)+".";if(d){return'<abbr title="'+b+'"><code><i class="icon-barcode"></i> '+c+"</code></abbr>";
}else{return c;}};})(window.mydmam.manager.jobs.view);(function(a){a.getNameCol=function(b){return"<strong>"+b.name+"</strong>";
};})(window.mydmam.manager.jobs.view);(function(a){a.getStatusCol=function(d){var b="";
var c=i18n("manager.jobs.status."+d.status);if(d.status==="WAITING"){b=b+'<span class="label">'+c+"</span>";
}else{if(d.status==="PREPARING"){b=b+'<span class="label label-warning">'+c+"</span>";
}else{if(d.status==="PROCESSING"){b=b+'<span class="label label-warning">'+c+"</span>";
}else{if(d.status==="DONE"){b=b+'<span class="label">'+c+"</span>";}else{if(d.status==="TOO_OLD"){b=b+'<span class="label label-info">'+c+"</span>";
}else{if(d.status==="STOPPED"){b=b+'<span class="label label-info">'+c+"</span>";
}else{if(d.status==="TOO_LONG_DURATION"){b=b+'<span class="label label-info">'+c+"</span>";
}else{if(d.status==="CANCELED"){b=b+'<span class="label label-info">'+c+"</span>";
}else{if(d.status==="POSTPONED"){b=b+'<span class="label label-info">'+c+"</span>";
}else{if(d.status==="ERROR"){b=b+'<span class="label badge-important">'+c+"</span>";
}else{b=b+'<span class="label label-inverse">'+c+"</span>";}}}}}}}}}}return b;};})(window.mydmam.manager.jobs.view);
(function(a){a.getDateCol=function(d){var c="";var b=function(f,e){return'<span class="label itemtoupdate agoupdate" data-varname="'+e+'" style="margin-bottom: 6px;"><em>('+mydmam.format.timeAgo(f,"manager.jobs.since","manager.jobs.negativesince")+")</em></span><br />";
};c=c+'<div class="collapse">';c=c+'<span class="label itemtoupdate dateupdate" data-varname="create_date">'+i18n("manager.jobs.create_date",mydmam.format.fulldate(d.create_date))+"</span><br />";
c=c+b(d.create_date,"create_date");if(d.start_date>0){c=c+'<span class="label itemtoupdate dateupdate" data-varname="start_date">'+i18n("manager.jobs.start_date",mydmam.format.fulldate(d.start_date))+"</span><br />";
c=c+b(d.start_date,"start_date");}c=c+"</div>";if(d.end_date>0){c=c+'<span class="label itemtoupdate dateupdate" data-varname="end_date">'+i18n("manager.jobs.end_date",mydmam.format.fulldate(d.end_date))+"</span>";
c=c+'<div class="collapse">';c=c+b(d.end_date,"end_date");}else{c=c+'<span class="label itemtoupdate dateupdate" data-varname="update_date">'+i18n("manager.jobs.update_date",mydmam.format.fulldate(d.update_date))+"</span>";
c=c+'<div class="collapse">';c=c+b(d.update_date,"update_date");}if((d.expiration_date-d.create_date)<mydmam.manager.jobs.default_max_expiration_time){c=c+'<span class="label itemtoupdate dateupdate" data-varname="expiration_date">'+i18n("manager.jobs.expiration_date",mydmam.format.fulldate(d.expiration_date))+"</span><br />";
c=c+b(d.expiration_date,"expiration_date");}if(d.end_date>0){c=c+'<span class="label itemtoupdate dateupdate" data-varname="update_date">'+i18n("manager.jobs.update_date",mydmam.format.fulldate(d.update_date))+"</span>";
c=c+b(d.update_date,"update_date");}c=c+"</div>";return c;};})(window.mydmam.manager.jobs.view);
(function(a){a.getStacktrace=function(c){var b="";b=b+c["class"]+": "+c.message+"\n";
for(var e=0;e<c.stacktrace.length;e++){var d=c.stacktrace[e];b=b+String.fromCharCode(160)+"at"+String.fromCharCode(160)+d["class"]+"."+d.method;
if(d.line===-2){b=b+"(Native Method)";}else{if(d.file){if(d.line>=0){b=b+"("+d.file+":"+d.line+")";
}else{b=b+"("+d.file+")";}}else{b=b+"(Unknown Source)";}}b=b+"\n";}if(c.cause){b=b+"Caused by: ";
b=b+a.getStacktrace(c.cause);}b=b+"";return b;};})(window.mydmam.manager.jobs.view);
(function(a){a.getParamCol=function(f){var d="";if(f.context){d=d+""+a.displayClassName(f.context.classname);
}d=d+'<div class="pull-right">';d=d+'<span class="badge badge-important itemtoupdate" data-varname="priority">';
if(f.priority>0){d=d+i18n("manager.jobs.priority",f.priority);}d=d+"</span> ";d=d+'<span class="badge badge-important itemtoupdate" data-varname="urgent">';
if(f.urgent){d=d+i18n("manager.jobs.urgent");}d=d+"</span>";d=d+"</div>";d=d+'<div class="collapse">';
if(f.instance_status_creator_key&f.instance_status_creator_hostname){d=d+i18n("manager.jobs.createdby",a.displayClassName(f.creator),'<abbr title="'+f.instance_status_creator_key+'">'+f.instance_status_creator_hostname+"</abbr>")+"<br />";
}else{d=d+i18n("manager.jobs.createdbysimple",a.displayClassName(f.creator))+"<br />";
}d=d+'<hr style="margin-top: 8px; margin-bottom: 5px;">';if(f.require_key){var c=mydmam.manager.jobs.list[f.require_key];
if(c){d=d+'<abbr title="'+a.displayKey(c.key,false)+'">';d=d+'<span class="label label-info">';
d=d+i18n("manager.jobs.requireto")+" "+c.name+" ("+i18n("manager.jobs.status."+c.status)+")";
d=d+"</span>";d=d+"</abbr>";d=d+"<br />";}else{d=d+"Rq "+a.displayKey(f.require_key,true)+"<br />";
}d=d+'<hr style="margin-top: 8px; margin-bottom: 5px;">';}var e=false;if(f.max_execution_time<(1000*3600*24)){if(f.max_execution_time>(3600*1000)){d=d+'<span class="label">'+i18n("manager.jobs.max_execution_time_hrs",Math.round((f.max_execution_time/(3600*1000))))+"</span><br />";
}else{d=d+'<span class="label">'+i18n("manager.jobs.max_execution_time_sec",(f.max_execution_time/1000))+"</span><br />";
}e=true;}if(f.delete_after_completed){d=d+'<span class="label label-inverse">'+i18n("manager.jobs.delete_after_completed")+"</span><br />";
e=true;}if(jQuery.isEmptyObject(f.processing_error)===false){if(e){d=d+'<hr style="margin-top: 8px; margin-bottom: 5px;">';
}d=d+'<code class="json stacktrace">'+a.getStacktrace(f.processing_error)+"</code>";
e=true;}if(f.context){if(f.context.neededstorages|(jQuery.isEmptyObject(f.context.content)===false)){if(e){d=d+'<hr style="margin-top: 8px; margin-bottom: 5px;">';
}d=d+i18n("manager.jobs.setup");}d=d+'<div class="pull-right">'+a.displayKey(f.key,true)+"</div>";
if(f.context.neededstorages){if(f.context.neededstorages.length>0){d=d+'<small><div style="margin-bottom: 5px;">'+i18n("manager.jobs.neededstorages")+" ";
for(var b=0;b<f.context.neededstorages.length;b++){d=d+'<i class="icon-hdd"></i> '+f.context.neededstorages[b];
if((b+1)<f.context.neededstorages.length){d=d+", ";}}d=d+"</div></small>";}}if(jQuery.isEmptyObject(f.context.content)===false){d=d+'<code class="json"><i class="icon-indent-left"></i><span class="jsontitle"> '+i18n("manager.jobs.context")+" </span>";
d=d+JSON.stringify(f.context.content,null," ");d=d+"</code>";}}else{if(e){d=d+'<hr style="margin-top: 8px; margin-bottom: 5px;">';
}d=d+"<div>"+a.displayKey(f.key,true)+"</div>";}d=d+"</div>";return d;};})(window.mydmam.manager.jobs.view);
(function(a){a.update=function(c){var d=function(f,g){if(g>0){f.find("em").html("("+mydmam.format.timeAgo(g,"manager.jobs.since","manager.jobs.negativesince")+")");
}else{f.find("em").empty();}};var b=function(h,f,g){if(g>0){h.html(i18n("manager.jobs."+f,mydmam.format.fulldate(g)));
}else{h.empty();}};var e=function(){var f=$(this).data("varname");var h=$(this);if(h.hasClass("agoupdate")){if(f==="create_date"){d(h,c.create_date);
}else{if(f==="start_date"){d(h,c.start_date);}else{if(f==="update_date"){d(h,c.update_date);
}else{if(f==="expiration_date"){if((c.expiration_date-c.create_date)<mydmam.manager.jobs.default_max_expiration_time){d(h,c.expiration_date);
}else{h.remove();}}else{if(f==="end_date"){d(h,c.end_date);}}}}}}else{if(h.hasClass("dateupdate")){if(f==="create_date"){b(h,f,c.create_date);
}else{if(f==="start_date"){b(h,f,c.start_date);}else{if(f==="update_date"){b(h,f,c.update_date);
}else{if(f==="expiration_date"){if((c.expiration_date-c.create_date)<mydmam.manager.jobs.default_max_expiration_time){b(h,f,c.expiration_date);
}else{h.remove();}}else{if(f==="end_date"){b(h,f,c.end_date);}}}}}}else{if(h.hasClass("updateprogression")){var g=c.progression;
if(f==="step"){h.html(a.getProgressionStepHtmlContent(g));}else{if(f==="percent"){h.css("width",((g.progress/g.progress_size)*100)+"%");
}else{if(f==="progress"){h.html(g.progress+"/"+g.progress_size);}else{if(f==="last_message"){h.html(a.getProgressionLastmessageHtmlContent(g));
}else{if(f==="last_caller"){h.html(a.displayClassName(g.last_caller));}}}}}}else{if(f=="priority"){if(c.priority>0){h.html(i18n("manager.jobs.priority",c.priority));
}else{h.empty();}}else{if(f=="urgent"){if(c.urgent){h.html(i18n("manager.jobs.urgent"));
}else{h.empty();}}}}}}};c.web.jqueryrow.find(".itemtoupdate").each(e);};})(window.mydmam.manager.jobs.view);
(function(a){a.getProgressionStepHtmlContent=function(b){if((b.step===0)&(b.step_count===0)){return"";
}if(b.step>b.step_count){return b.step;}var c="";c=c+b.step;c=c+' <i class="icon-arrow-right"></i> ';
c=c+b.step_count;return c;};})(window.mydmam.manager.jobs.view);(function(a){a.getProgressionLastmessageHtmlContent=function(c){var b=i18n("job.progressionmessage."+c.last_message);
if(b.startsWith("job.progressionmessage.")){b=c.last_message;}return b;};})(window.mydmam.manager.jobs.view);
(function(a){a.getProgressionCol=function(e){var d="";if(e.progression){var b=e.progression;
d=d+'<strong class="pull-left itemtoupdate updateprogression" data-varname="step" style="margin-right: 5px;">';
d=d+a.getProgressionStepHtmlContent(b);d=d+"</strong>";if(e.status==="DONE"){d=d+'<div class="progress progress-success" style="margin-bottom: 5px;">';
d=d+'<div class="bar" style="width: 100%;"></div>';d=d+"</div>";}else{var c=(b.progress/b.progress_size)*100;
if(e.status==="PROCESSING"){d=d+'<div class="progress progress-striped active" style="margin-bottom: 5px;">';
}else{d=d+'<div class="progress progress-danger" style="margin-bottom: 5px;">';}d=d+'<div class="bar itemtoupdate updateprogression" data-varname="percent" style="width: '+c+'%;"></div>';
d=d+"</div>";d=d+'<div class="collapse itemtoupdate updateprogression" data-varname="progress">';
d=d+b.progress+"/"+b.progress_size;d=d+"</div>";}d=d+'<div class="collapse"><small>';
d=d+'<hr style="margin-top: 4px; margin-bottom: 3px;">';d=d+i18n("manager.jobs.last_message")+" ";
d=d+'<em class="itemtoupdate updateprogression" data-varname="last_message">';d=d+a.getProgressionLastmessageHtmlContent(e.progression);
d=d+'</em> <i class="icon-comment"></i>';if(b.last_caller){d=d+"<br />";d=d+i18n("manager.jobs.last_message_let_by")+" ";
d=d+'<span class="itemtoupdate updateprogression" data-varname="last_caller">';d=d+a.displayClassName(b.last_caller);
d=d+"</span>";}if(e.worker_class&e.worker_reference&e.instance_status_executor_key&e.instance_status_executor_hostname){d=d+"<br />";
d=d+'<hr style="margin-top: 4px; margin-bottom: 3px;">';d=d+i18n("manager.jobs.worker")+" "+a.displayClassName(e.worker_class)+" ";
d=d+"("+a.displayKey(e.worker_reference,true)+")<br>";d=d+i18n("manager.jobs.instanceexecutor")+' <abbr title="'+e.instance_status_executor_key+'">'+e.instance_status_executor_hostname+"</abbr><br />";
}d=d+"</small></div>";}return d;};})(window.mydmam.manager.jobs.view);(function(a){a.getButtonsCol=function(d){var j=function(n,o,q,m){var p="";
p=p+'<button class="btn btn-mini '+n+' btn-block btnjobaction" data-target-order="'+m+'" data-target-key="'+d.key+'">';
p=p+'<i class="'+o+'"></i> ';p=p+i18n(q);p=p+"</button>";return p;};var e=j("btn-danger","icon-trash icon-white","manager.jobs.btn.delete","delete");
var b=j("btn-danger","icon-stop icon-white","manager.jobs.btn.stop","stop");var f=j("","icon-inbox","manager.jobs.btn.setinwait","setinwait");
var c=j("btn-info","icon-off icon-white","manager.jobs.btn.cancel","cancel");var g=j("","icon-warning-sign","manager.jobs.btn.hipriority","hipriority");
var k=j("","icon-step-forward","manager.jobs.btn.postponed","postponed");var h="";
if((d.expiration_date-d.create_date)<mydmam.manager.jobs.default_max_expiration_time){h=j("","icon-calendar","manager.jobs.btn.noexpiration","noexpiration");
}var l='<div class="collapse" style=" margin-top: 5px;">';var i="";if(d.isThisStatus("PROCESSING")){i=i+b;
return i;}if(d.isThisStatus("WAITING")){i=i+g;i=i+l;i=i+k;i=i+c;i=i+h;i=i+e;i=i+"</div>";
return i;}if(d.isThisStatus(["CANCELED","POSTPONED","DONE"])){i=i+f;i=i+l;if(d.isThisStatus(["CANCELED","DONE"])){i=i+k;
}i=i+h;i=i+e;i=i+"</div>";return i;}if(d.isThisStatus(["ERROR","STOPPED","TOO_LONG_DURATION","TOO_OLD"])){i=i+c;
i=i+l;i=i+k;i=i+f;i=i+h;i=i+e;i=i+"</div>";return i;}return i;};})(window.mydmam.manager.jobs.view);
