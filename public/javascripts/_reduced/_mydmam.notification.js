(function(a){if(!a.notification){a.notification={};}if(!a.notification.url){a.notification.url={};
}})(window.mydmam);(function(a){a.ajaxError=function(c,d,b){$("#errorplaceholder").append('<div class="alert"><button type="button" class="close" data-dismiss="alert">&times;</button><strong>'+c+"</strong> "+d+", "+b+"</div>");
};})(window.mydmam.notification);(function(a){a.setReadNotification=function(){if($(this).hasClass("btnsetreadnotification")===false){return;
}$(this).removeClass("btnsetreadnotification");var b=$(this).data("notificationkey");
var c=a.url.notificationupdateread.replace("keyparam1",b);$.ajax({url:c,type:"GET",async:true,error:function(d,f,e){a.ajaxError(i18n("userprofile.notifications.errorduringsetread"),f,e);
},success:function(d){if(!d.result){console.log(d);}}});};})(window.mydmam.notification);
(function(a){a.getAndDisplayUsers=function(){var b=function(j,g){var h=$(j).text();
if(g[h]){var i='<a href="mailto:'+g[h].name+"<"+g[h].mail+'>">'+g[h].name+"</a>";
$(j).html(i);}else{$(j).html(i18n("userprofile.notifications.unknown"));}};var c;
var d=[];var f=a.dom_element_list_for_user_to_resolve;for(var e in f){c=$(f[e]).text();
if(d.indexOf(c)===-1){d.push(c);}}$.ajax({url:a.url.notificationresolveusers,type:"POST",async:false,data:{users_crypted_keys:d},error:function(g,i,h){a.ajaxError(i18n("userprofile.notifications.errorduringgetusers"),i,h);
},success:function(g){$(".userprofilekey").each(function(){b(this,g);});}});};})(window.mydmam.notification);
(function(a){a.displayStatus=function(b){var c="";if(b==="WAITING"){c="badge-info";
}else{if(b==="PREPARING"){c="badge-warning";}else{if(b==="PROCESSING"){c="badge-warning";
}else{if(b==="POSTPONED"){c="badge-info";}else{if(b==="STOPPED"){c="badge-inverse";
}else{if(b==="CANCELED"){c="badge-important";}else{if(b==="ERROR"){c="badge-important";
}else{if(b==="TOO_OLD"){c="badge-important";}else{if(b==="DONE"){c="badge-success";
}}}}}}}}}return'<span class="badge '+c+'">'+i18n("manager.jobs.status."+b)+"</span>";
};})(window.mydmam.notification);(function(b,a){b.getAndDisplayJobs=function(){var c=a.manager.jobs.view;
var d=function(m,i){var j=$(m).text();if(i[j]){var l=i[j];var k="";k=k+'<div class="row-fluid">';
k=k+'<div class="span2">';k=k+c.getNameCol(l);k=k+"</div>";k=k+'<div class="span2">';
k=k+c.getStatusCol(l);k=k+"</div>";k=k+'<div class="span3">';k=k+c.getDateCol(l);
k=k+"</div>";k=k+'<div class="span5">';k=k+c.getProgressionCol(l);k=k+c.getParamCol(l);
k=k+"</div>";k=k+"</div>";$(m).html(k);$(m).find("div.collapse").removeClass("collapse");
console.log(i[j]);}else{$(m).html("<p>"+i18n("userprofile.notifications.cantfoundjob",j)+"</p>");
}$(m).find(".jobkeyraw").remove();};var e;var f=[];var h=b.dom_element_list_for_job_resolve;
for(var g in h){e=$(h[g]).text();if(f.indexOf(e)===-1){f.push(e);}}$.ajax({url:b.url.associatedjobs,type:"POST",async:true,data:{job_keys:f},error:function(i,k,j){b.ajaxError(i18n("userprofile.notifications.errorduringgetjobs"),k,j);
},success:function(i){$(".jobsummary").each(function(){d(this,i);});}});};})(window.mydmam.notification,window.mydmam);
(function(a){a.postProcessPage=function(b){$(".redrawstatus").each(function(){$(this).html(a.displayStatus($(this).data("status")));
});if(b===false){$(".btnsetreadnotification").each(function(){$(this).click(a.setReadNotification);
});}a.dom_element_list_for_user_to_resolve=[];$(".userprofilekey").each(function(){a.dom_element_list_for_user_to_resolve.push(this);
});a.getAndDisplayUsers();if(b===false){a.dom_element_list_for_job_resolve=[];$(".jobsummary").each(function(){a.dom_element_list_for_job_resolve.push(this);
});a.getAndDisplayJobs();}if(b){$(".notificationsadmindatatable").dataTable({bPaginate:false,bLengthChange:false,bSort:false,bInfo:false,bAutoWidth:false,bFilter:true,aoColumnDefs:[{bSortable:false,aTargets:[0,1,2,3,4,5]},{bSearchable:true,aTargets:[1,2,3,4]},{bSearchable:false,aTargets:[0,5]}]});
$("#sitesearch").bind("keyup.DT",function(c){var d=this.value===""?"":this.value;
$(".dataTables_filter input").val(d);$(".dataTables_filter input").trigger("keyup.DT");
});}};})(window.mydmam.notification);