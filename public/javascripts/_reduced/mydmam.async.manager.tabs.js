(function(a){a.Summaries=React.createClass({displayName:"Summaries",render:function(){var b=[];
for(var c in this.props.summaries){b.push(React.createElement(a.InstanceSummary,{key:c,instance:this.props.summaries[c]}));
}return(React.createElement("table",{className:"table table-bordered table-striped table-condensed"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,i18n("manager.instance.host")),React.createElement("th",null,i18n("manager.instance.manager")),React.createElement("th",null,i18n("manager.instance.version")),React.createElement("th",null,i18n("manager.instance.uptime")),React.createElement("th",null,i18n("manager.instance.jvm")),React.createElement("th",null,i18n("manager.instance.addr")))),React.createElement("tbody",null,b)));
}});a.InstanceSummary=React.createClass({displayName:"InstanceSummary",render:function(){var c=[];
for(var b in this.props.instance.host_addresses){c.push(React.createElement("span",{key:b},"• ",this.props.instance.host_addresses[b],React.createElement("br",null)));
}return(React.createElement("tr",null,React.createElement("td",null,this.props.instance.host_name,React.createElement("br",null),React.createElement("small",{className:"muted"},"PID: ",this.props.instance.pid)),React.createElement("td",null,this.props.instance.instance_name,React.createElement("br",null),React.createElement("em",null,this.props.instance.app_name)),React.createElement("td",null,this.props.instance.app_version),React.createElement("td",null,React.createElement(mydmam.async.pathindex.reactSinceDate,{i18nlabel:"manager.instance.uptime",date:this.props.instance.starttime})),React.createElement("td",null,this.props.instance.java_version,React.createElement("br",null),React.createElement("small",{className:"muted"},this.props.instance.java_vendor)),React.createElement("td",null,c)));
}});a.ThreadsInstancesNavList=React.createClass({displayName:"ThreadsInstancesNavList",getInitialState:function(){return{instance_selected:null};
},onSelectInstance:function(b){this.props.onSelectInstance(b);this.setState({instance_selected:b});
},onSelectItem:function(b){this.props.onSelectItem(b);},render:function(){var h=[];
for(var e in this.props.summaries){var c=this.props.summaries[e];var f=classNames({active:this.state.instance_selected==e});
h.push(React.createElement("li",{key:e,className:f},React.createElement(a.InstancesNavListElement,{reference:e,onSelect:this.onSelectInstance},c.instance_name," ",React.createElement("small",null,"(",c.app_name,")"))));
}var d=null;if(this.props.item_list_i18n_title){d=(React.createElement("li",{className:"nav-header"},i18n(this.props.item_list_i18n_title)));
}var b=[];for(var i in this.props.items){var g=this.props.items[i];b.push(React.createElement("li",{key:i},React.createElement(a.InstancesNavListElement,{reference:i,onSelect:this.onSelectItem},g)));
}return(React.createElement("div",{className:"row-fluid"},React.createElement("div",{className:"span4"},React.createElement("div",{className:"well",style:{padding:"8px 0"}},React.createElement("ul",{className:"nav nav-list"},React.createElement("li",{className:"nav-header"},i18n("manager.instancepane")),h,d,b))),React.createElement("div",{className:"span8"},this.props.children)));
}});a.Threads=React.createClass({displayName:"Threads",getInitialState:function(){return{thread_list:{},selected_instance:null};
},componentWillMount:function(){mydmam.async.request("instances","allthreads",null,function(b){this.setState({thread_list:b});
}.bind(this));},onSelectInstance:function(b){this.setState({selected_instance:b});
$("html, body").scrollTop(0);},onSelectThread:function(b){var c=React.findDOMNode(this.refs[b]).getBoundingClientRect().y;
$("html, body").scrollTop($("html, body").scrollTop()+c-50);},onGotoTheTop:function(b){b.preventDefault();
$("html, body").scrollTop(0);},render:function(){if(this.state.selected_instance==null){return(React.createElement(a.ThreadsInstancesNavList,{onSelectInstance:this.onSelectInstance,summaries:this.props.summaries}));
}var h=this.state.thread_list[this.state.selected_instance];if(h==null){return(React.createElement(a.ThreadsInstancesNavList,{onSelectInstance:this.onSelectInstance,summaries:this.props.summaries}));
}h.sort(function(l,k){return l.id>k.id;});var d=[];var c=[];for(var f in h){var e=h[f];
var b=null;if(e.isdaemon){b=(React.createElement("span",null,React.createElement("span",{className:"badge badge-important"},"DAEMON")," "));
}var i=[];if(e.execpoint==""){i.push(React.createElement("div",{key:"-1"},e.classname));
}else{var j=e.execpoint.split("\n");for(var g in j){i.push(React.createElement("div",{key:g},j[g]));
}}d.push(React.createElement("div",{key:f,ref:f},React.createElement("h4",null,React.createElement("a",{href:location.hash,onClick:this.onGotoTheTop},React.createElement("i",{className:" icon-arrow-up",style:{marginRight:5,marginTop:5}})),e.name),React.createElement("span",{className:"badge badge-inverse"},"#",e.id)," ",React.createElement("span",{className:"label label-info"},e.state)," ",b,React.createElement("span",{className:"label"},"Time: ",e.cpu_time_ms/1000," sec"),React.createElement("br",null),React.createElement("div",{className:"thread-stacktrace"},i)));
c.push(React.createElement("span",null,e.id," • ",e.name.substring(0,50)));}return(React.createElement(a.ThreadsInstancesNavList,{summaries:this.props.summaries,onSelectInstance:this.onSelectInstance,onSelectItem:this.onSelectThread,items:c,item_list_i18n_title:"manager.threads"},d));
}});a.Perfstats=React.createClass({displayName:"Perfstats",getInitialState:function(){return{list:{},interval:null};
},componentWillMount:function(){this.refresh();},refresh:function(){mydmam.async.request("instances","allperfstats",null,function(b){this.setState({list:b});
}.bind(this));},componentDidMount:function(){this.setState({interval:setInterval(this.refresh,5000)});
},componentWillUnmount:function(){if(this.state.interval){clearInterval(this.state.interval);
}},render:function(){var b=[];for(var d in this.state.list){var c=null;if(this.props.summaries[d]){c=this.props.summaries[d];
}b.push(React.createElement(a.PerfstatsInstance,{key:d,instance:this.state.list[d],summary:c}));
}return(React.createElement("div",null,b));}});a.PerfstatsInstance=React.createClass({displayName:"PerfstatsInstance",render:function(){var o=this.props.instance;
var m=function(q){if(q>1000*1000*10){return mydmam.format.number(Math.round(q/(1000*1000)))+" MB";
}else{return mydmam.format.number(q)+" bytes";}};var g=null;var h=null;if(this.props.summary!=null){var j=this.props.summary;
g=(React.createElement("table",{className:"table table-bordered table-striped table-condensed table-hover pull-right",style:{width:"inherit"}},React.createElement("tbody",null,React.createElement("tr",null,React.createElement("th",null,"App name"),React.createElement("td",null,j.app_name)),React.createElement("tr",null,React.createElement("th",null,"Host"),React.createElement("td",null,j.os_name," ",j.os_version," (",j.os_arch,")")),React.createElement("tr",null,React.createElement("th",null,"CPU Count"),React.createElement("td",null,j.cpucount)),React.createElement("tr",null,React.createElement("th",null,"User"),React.createElement("td",null,j.user_name," ",j.user_language,"_",j.user_country," ",j.user_timezone)),React.createElement("tr",null,React.createElement("th",null,"JVM uptime"),React.createElement("td",null,React.createElement(mydmam.async.pathindex.reactSinceDate,{i18nlabel:"manager.instance.uptime",date:j.starttime,style:{marginLeft:0}}))))));
}var b=null;if(o.now+2000<Date.now()){b=(React.createElement(mydmam.async.pathindex.reactSinceDate,{i18nlabel:"manager.perfstats.since",date:o.now}));
}var p=(o.freeMemory/o.maxMemory)*100;var f=((o.totalMemory/o.maxMemory)*100)-p;var k=((o.heapUsed/o.maxMemory)*100);
var i=((o.nonHeapUsed/o.maxMemory)*100);var c=[];for(var l in o.gc){var n=o.gc[l];
c.push(React.createElement("tr",{key:l},React.createElement("th",null,n.name),React.createElement("td",null,n.time/1000," sec"),React.createElement("td",null,n.count," items")));
}var e=null;if(o.os){var d=o.os;e=(React.createElement("table",{className:"table table-bordered table-striped table-condensed table-hover",style:{width:"inherit"}},React.createElement("tr",null,React.createElement("th",null,"CPU load"),React.createElement("td",null,"JVM process: ",Math.round(d.getProcessCpuLoad*100)/100),React.createElement("td",{colSpan:"2"},"System: ",Math.round(d.getSystemCpuLoad*100)/100)),React.createElement("tr",null,React.createElement("th",null,"JVM CPU time"),React.createElement("td",{colSpan:"3"},Math.round(d.getProcessCpuTime/(1000*1000*100))/100," sec")),React.createElement("tr",null,React.createElement("th",null,"Physical memory"),React.createElement("td",null,"Free: ",m(d.getFreePhysicalMemorySize)),React.createElement("td",null,"Total: ",m(d.getTotalPhysicalMemorySize)),React.createElement("td",null,"Used: ",Math.floor(((d.getTotalPhysicalMemorySize-d.getFreePhysicalMemorySize)/d.getTotalPhysicalMemorySize)*100),"%")),React.createElement("tr",null,React.createElement("th",null,"Swap"),React.createElement("td",null,"Free: ",m(d.getFreeSwapSpaceSize)),React.createElement("td",null,"Total: ",m(d.getTotalSwapSpaceSize)),React.createElement("td",null,"Used: ",Math.floor(((d.getTotalSwapSpaceSize-d.getFreeSwapSpaceSize)/d.getTotalSwapSpaceSize)*100),"%")),React.createElement("tr",null,React.createElement("td",{colSpan:"4"},"Committed virtual memory size: ",m(d.getCommittedVirtualMemorySize)))));
}return(React.createElement("div",null,React.createElement("h4",null,o.instance_name," ",React.createElement("small",{className:"muted"},o.pid,"@",o.host_name)," ",React.createElement("span",{className:"badge badge-important"},"Load ",Math.round(o.getSystemLoadAverage*100)/100)," ",b),g,React.createElement("div",{style:{marginLeft:"15px"}},"Memory free: ",m(o.freeMemory),", total: ",m(o.totalMemory),", max: ",m(o.maxMemory),".",React.createElement("br",null),React.createElement("div",{className:"progress",style:{width:"40%"}},React.createElement("div",{className:"bar bar-warning",style:{width:f+"%"}}),React.createElement("div",{className:"bar bar-success",style:{width:p+"%"}})),React.createElement("p",null,"Classes count unloaded: ",o.getUnloadedClassCount,", loaded: ",o.getLoadedClassCount,", total loaded: ",o.getTotalLoadedClassCount,", object pending finalization: ",o.getObjectPendingFinalizationCount),"Heap memory: ",React.createElement("span",{className:"text-info"},m(o.heapUsed)),", non heap: ",React.createElement("span",{className:"text-error"},m(o.nonHeapUsed)),React.createElement("br",null),React.createElement("div",{className:"progress",style:{width:"40%"}},React.createElement("div",{className:"bar bar-info",style:{width:k+"%"}}),React.createElement("div",{className:"bar bar-danger",style:{width:i+"%"}})),e,React.createElement("table",{className:"table table-bordered table-striped table-condensed table-hover",style:{width:"inherit"}},React.createElement("tbody",null,c))),React.createElement("hr",null)));
}});a.Classpaths=React.createClass({displayName:"Classpaths",getInitialState:function(){return{list:{}};
},componentWillMount:function(){mydmam.async.request("instances","allclasspaths",null,function(b){this.setState({list:b});
}.bind(this));},render:function(){var d=[];var c=[];var g;for(var f in this.state.list){g=this.state.list[f];
for(var h in g){if(c.indexOf(g[h])==-1){c.push(g[h]);}}}for(h in c){for(var f in this.state.list){g=this.state.list[f];
if(g.indexOf(c[h])==-1){var b=f;if(this.props.summaries[f]){if(this.props.summaries[f]!=="nope"){var e=this.props.summaries[f];
b=e.instance_name+" ("+e.app_name+") "+e.host_name;}else{b=i18n("manager.classpath.notfound")+" :: "+f;
}}else{b=i18n("manager.classpath.notfound")+" :: "+f;}d.push(React.createElement("tr",{key:md5(c[h]+f)},React.createElement("td",null,c[h]),React.createElement("td",null,b)));
}}}return(React.createElement("table",{className:"table table-bordered table-striped table-condensed"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,i18n("manager.classpath.missing")),React.createElement("th",null,i18n("manager.classpath.missingin")))),React.createElement("tbody",null,d)));
}});})(window.mydmam.async.manager);