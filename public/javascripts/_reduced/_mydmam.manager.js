(function(a){a.display=function(b){$.ajax({url:mydmam.manager.url.allinstances,type:"POST",beforeSend:function(){$(b).html(i18n("manager.loading"));
},error:function(c,e,d){$(b).html('<div class="alert alert-info"><button type="button" class="close" data-dismiss="alert">&times;</button><strong>'+e+"</strong></div>");
},success:function(c){if((c==null)|c.length===0){$("#laststatusworkers").append('<div class="alert alert-info"><button type="button" class="close" data-dismiss="alert">&times;</button><strong>'+i18n("manager.nodetectedmodule")+"</strong></div>");
return;}a.showFullDisplay(c,b);}});};})(window.mydmam.manager);(function(a){a.hasInstanceAction=function(){if(mydmam.manager.url.instanceaction){return true;
}return false;};})(window.mydmam.manager);(function(a){a.getGitHubURL=function(b,c){if(c==null){return"https://github.com/hdsdi3g/MyDMAM/tree/"+b.substring(b.lastIndexOf(" ")+1,b.length);
}else{return"https://github.com/hdsdi3g/MyDMAM/tree/"+b.substring(b.lastIndexOf(" ")+1,b.length)+"/app/"+c;
}};})(window.mydmam.manager);(function(a){a.showFullDisplay=function(c,b){var e="";
if(window.location.hash===""){window.location.hash="#mgrsummary";}var d=function(g){if(g===window.location.hash){return"active";
}else{return"";}};e=e+'<ul class="nav nav-tabs">';e=e+'<li class="'+d("#mgrsummary")+'"><a href="#mgrsummary" class="btnmanager">'+i18n("manager.summary.title")+"</a></li>";
e=e+'<li class="'+d("#mgrworkers")+'"><a href="#mgrworkers" class="btnmanager">'+i18n("manager.workers.title")+"</a></li>";
e=e+'<li class="'+d("#mgrcyclic")+'"><a href="#mgrcyclic" class="btnmanager">'+i18n("manager.cyclic.title")+"</a></li>";
e=e+'<li class="'+d("#mgrtriggers")+'"><a href="#mgrtriggers" class="btnmanager">'+i18n("manager.trigger.title")+"</a></li>";
e=e+'<li class="'+d("#mgrthreads")+'"><a href="#mgrthreads" class="btnmanager">'+i18n("manager.threads.title")+"</a></li>";
e=e+'<li class="'+d("#mgrclasspaths")+'"><a href="#mgrclasspaths" class="btnmanager">'+i18n("manager.classpaths.title")+"</a></li>";
e=e+'<li class="pull-right"><a href="#mgrsummary" class="btnrefresh"><i class="icon-refresh"></i></a></li>';
e=e+"</ul>";e=e+'<div class="tab-content">';e=e+'<div class="tab-pane '+d("#mgrsummary")+'" id="mgrsummary">';
e=e+'<table class="table table-striped table-bordered table-hover table-condensed setdatatable">';
e=e+"<thead>";e=e+a.prepareSummary(null);e=e+"</thead>";e=e+"<tbody>";for(var f=0;
f<c.length;f++){e=e+a.prepareSummary(c[f],f);}e=e+"</tbody>";e=e+"</table>";e=e+"</div>";
e=e+'<div class="tab-pane '+d("#mgrthreads")+'" id="mgrthreads">';e=e+a.prepareThreadsStackTrace(c);
e=e+"</div>";e=e+'<div class="tab-pane '+d("#mgrclasspaths")+'" id="mgrclasspaths">';
e=e+a.prepareClasspaths(c);e=e+"</div>";e=e+'<div class="tab-pane '+d("#mgrcyclic")+'" id="mgrcyclic">';
e=e+a.jobcreator.prepareCyclic(c);e=e+"</div>";e=e+'<div class="tab-pane '+d("#mgrtriggers")+'" id="mgrtriggers">';
e=e+a.jobcreator.prepareTriggers(c);e=e+"</div>";e=e+'<div class="tab-pane '+d("#mgrworkers")+'" id="mgrworkers">';
e=e+"</div>";$(b).html(e);a.workerstatus.refresh("#mgrworkers");$(b+" table.setdatatable").dataTable({bPaginate:false,bLengthChange:false,bSort:true,bInfo:false,bAutoWidth:false,bFilter:true});
$(b+" table.setdatatable").removeClass("setdatatable");$(b+" ul.nav.nav-tabs a.btnmanager").click(function(){window.location.hash=$(this).attr("href");
$(this).tab("show");return false;});$(b+" ul.nav.nav-tabs a.btnrefresh").click(function(){a.display(b);
return false;});$(b+" button.btn.btn-mini.btnincollapse").click(function(){var g=$(this).data("collapsetarget");
$(b+" div.collapse."+g).addClass("in");$(this).remove();return true;});if(a.hasInstanceAction()){a.setBtnActionClick(b);
}};})(window.mydmam.manager);(function(b){b.doAction=function(g,e,f,i,h,d,j){var c={};
c[f]=i;$.ajax({url:b.url.instanceaction,type:"POST",data:{target_class_name:g,target_reference_key:e,json_order:JSON.stringify(c)},beforeSend:h,error:d,success:j});
};var a=function(){var c=$(this);if(!b.url.instanceaction){c.remove();return false;
}if(c.hasClass("disabled")){return false;}c.removeClass("btnmgraction");b.doAction(c.data("target_class_name"),c.data("target_reference_key"),c.data("order_key"),c.data("order_value"),function(){c.addClass("disabled");
},function(){c.removeClass("disabled");alert(i18n("manager.action.error"));},function(d){c.removeClass("disabled");
if(d.length!==0){console.err(d);}});};b.setBtnActionClick=function(c){$(c+" button.btn.btnmgraction").click(a);
};})(window.mydmam.manager);(function(a){a.prepareSummary=function(b,d){var c="<tr>";
if(b==null){c=c+"<th>"+i18n("manager.summary.instance_name")+"</th>";c=c+"<th>"+i18n("manager.summary.app_name")+"</th>";
c=c+"<th>"+i18n("manager.summary.uptime")+"</th>";c=c+"<th>"+i18n("manager.summary.java_version")+"</th>";
c=c+"<th>"+i18n("manager.summary.app_version")+"</th>";c=c+"<th>"+i18n("manager.summary.host")+"</th>";
c=c+"<th>"+i18n("manager.summary.addresses")+"</th>";if(a.hasInstanceAction()){c=c+"<th>"+i18n("manager.summary.actions")+"</th>";
}return c+"</tr>";}c=c+"<td>"+b.instance_name+"</td>";c=c+"<td><strong>"+b.app_name+"</strong><br><small>"+b.instance_name_pid+"</small></td>";
c=c+"<td>";c=c+b.uptime_from;if(b.next_updater_refresh_date>0){c=c+"<br><small>"+mydmam.format.timeAgo(b.next_updater_refresh_date,"manager.summary.next_updater_refresh_date.from","manager.summary.next_updater_refresh_date.to")+"</small>";
}c=c+"</td>";c=c+"<td>";if(b.java_version.startsWith("1.7.0")){c=c+'<a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html#jre-7u';
c=c+b.java_version.substring(b.java_version.lastIndexOf("_")+1,b.java_version.length)+'-oth-JPR">'+b.java_version+"</a>";
}else{if(b.java_version.startsWith("1.8.0")){c=c+'<a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html#jre-8u';
c=c+b.java_version.substring(b.java_version.lastIndexOf("_")+1,b.java_version.length)+'-oth-JPR">'+b.java_version+"</a>";
}else{c=c+b.java_version;}}c=c+"</td>";c=c+'<td><a href="'+a.getGitHubURL(b.app_version)+'">'+b.app_version+"</a></td>";
c=c+"<td>"+b.host_name+"</td>";c=c+"<td><small>";for(var d=0;d<b.host_addresses.length;
d++){c=c+b.host_addresses[d]+"<br/>";}c=c+"</small></td>";if(a.hasInstanceAction()){c=c+"<td>";
if(b.brokeralive){c=c+'<button class="btn btn-mini btnmgraction btn-danger" ';c=c+'data-target_class_name="AppManager" ';
c=c+'data-order_key="broker" ';c=c+'data-order_value="stop" ';c=c+'data-target_reference_key="'+b.instance_name_pid+'" ';
c=c+'><i class="icon-stop icon-white"></i> '+i18n("manager.summary.broker.stop");
}else{c=c+'<button class="btn btn-mini btnmgraction btn-success" ';c=c+'data-target_class_name="AppManager" ';
c=c+'data-order_key="broker" ';c=c+'data-order_value="start" ';c=c+'data-target_reference_key="'+b.instance_name_pid+'" ';
c=c+'><i class="icon-play icon-white"></i> '+i18n("manager.summary.broker.start");
}c=c+"</button>";c=c+"</td>";}return c+"</tr>";};})(window.mydmam.manager);(function(a){a.prepareThreadsStackTrace=function(f){var c=function(m,p,j){var l="";
l=l+'<table class="table table-striped table-bordered table-hover table-condensed setdatatable">';
l=l+"<thead>";l=l+"<th>"+i18n("manager.threads.tnamestate")+"</th>";l=l+"<th>"+i18n("manager.threads.tstacks")+"</th>";
l=l+"</thead>";l=l+"<tbody>";var o=m;o=o.sort(function(s,r){return s.id<r.id?-1:1;
});getStacktraceline=function(x){var r=x;if(r.startsWith("at hd3gtv.mydmam")===false){return r;
}if(r.startsWith("at ")===false){r="at "+r;}var u="";var s=r.indexOf("(");var v=r.indexOf(")");
var t=r.substring(s+1,v);var w=r.substring(3,s).replace(/\./g,"/");w=w.substring(0,w.lastIndexOf("/"));
w=w.substring(0,w.lastIndexOf("/"));w=w+"/"+t.substring(0,t.indexOf(":"));w=w+"#L"+t.substring(t.indexOf(":")+1,t.length);
u=u+r.substring(0,s+1);u=u+'<a href="'+a.getGitHubURL(j,w)+'">';u=u+t;u=u+"</a>";
u=u+")";return u;};for(var n=0;n<o.length;n++){var k=o[n];l=l+"<tr>";l=l+"<td>";l=l+'<span class="badge badge-info">'+k.id+"</span>";
if(k.state==="TIMED_WAITING"){l=l+' <span class="label label-warning">TIMED_WAITING</span>';
}else{if(k.state==="RUNNABLE"){l=l+' <span class="label label-important">RUNNABLE</span>';
}else{if(k.state==="TERMINATED"){l=l+' <span class="label label-label">TERMINATED</span>';
}else{l=l+' <span class="label label-success">'+k.state+"</span>";}}}if(k.isdaemon===false){l=l+' <span class="badge badge-important">Not a daemon</span>';
}l=l+"<br /><small>"+k.name+"</small>";l=l+'<br /><small><span class="muted">'+k.classname+"</span></small>";
l=l+"</td>";var q=k.execpoint.split("\n");l=l+"<td><small>";if(q.length>1){if(q.length>2){l=l+getStacktraceline(q[0])+"<br />";
var h="mgr-"+e+"-"+n;l=l+'<button class="btn btn-mini btnincollapse" data-collapsetarget="'+h+'"><i class="icon-chevron-down"></i></button>';
l=l+'<div class="collapse '+h+'">';for(var i=1;i<q.length-1;i++){var g=q[i];l=l+getStacktraceline(g)+"<br />";
}l=l+"</div>";}else{l=l+getStacktraceline(q[0])+"<br />";}}l=l+"</small></td>";l=l+"</tr>";
}l=l+"</tbody>";l=l+"</table>";return l;};var d="";for(var e=0;e<f.length;e++){var b=f[e];
d=d+"<p>";d=d+'<span class="label label-inverse">'+b.app_name+"</span> &bull; ";d=d+b.instance_name+" &bull; ";
d=d+"<code>"+b.instance_name_pid+"</code>";d=d+"</p>";d=d+c(b.threadstacktraces,e,b.app_version);
}return d;};})(window.mydmam.manager);(function(a){a.prepareClasspaths=function(b){var d={};
for(var i=0;i<b.length;i++){var k=b[i];for(var c=0;c<k.classpath.length;c++){var j=k.classpath[c];
if(d[j]){continue;}else{d[j]=true;}}}var g=function(n,m){for(var o=0;o<n.classpath.length;
o++){if(m===n.classpath[o]){return true;}}return false;};var e={};for(var j in d){for(var i=0;
i<b.length;i++){var k=b[i];if(g(k,j)===false){if(e[j]){e[j].push(k);}else{e[j]=[k];
}}}}var h="";h=h+"<blockquote><p>"+i18n("manager.classpaths.warnmessage")+"</p></blockquote>";
h=h+'<table class="table table-striped table-bordered table-hover table-condensed setdatatable">';
h=h+"<thead>";h=h+"<th>"+i18n("manager.classpaths.item")+"</th>";h=h+"<th>"+i18n("manager.classpaths.missinginstances")+"</th>";
h=h+"</thead>";h=h+"<tbody>";for(var j in d){h=h+"<tr>";h=h+"<td>"+j+"</td>";h=h+"<td>";
if(e[j]){h=h+"<small>";var l=e[j];for(var f=0;f<l.length;f++){h=h+l[f].instance_name_pid;
h=h+" ("+l[f].app_name+")";h=h+"<br>";}h=h+"</small>";}else{h=h+"<em>"+i18n("manager.classpaths.cpiseverywhere")+"</em>";
}h=h+"</td>";h=h+"</tr>";}h=h+"</tbody>";h=h+"</table>";return h;};})(window.mydmam.manager);
(function(a){a.prepareInstanceNameCell=function(b,c){var d="";d=d+"<strong>"+b.app_name+"</strong>&nbsp;&bull; ";
d=d+b.instance_name+"<br>";d=d+"<small>"+b.host_name+"</small>";d=d+'<span class="pull-right">'+mydmam.manager.jobs.view.displayKey(c,true)+"</span>";
return d;};})(window.mydmam.manager);(function(a){a.drawUseractionFunctionalityList=function(b,c,e){var d=function(k){var j="";
j=j+'<table class="table table-striped table-bordered table-hover table-condensed setdatatable">';
j=j+"<thead>";j=j+"<th>"+i18n("manager.jobcreator.th.instance")+"</th>";j=j+"<th>"+i18n("manager.uafunctlist.functionality")+"</th>";
j=j+"<th>"+i18n("manager.uafunctlist.functionality")+"</th>";j=j+"<th>"+i18n("manager.uafunctlist.capabilities")+"</th>";
j=j+"<th>"+i18n("manager.uafunctlist.storageindexeswhitelist")+"</th>";j=j+"</thead>";
j=j+"<tbody>";for(var l=0;l<c.length;l++){var o=c[l];var n=o.instance_name_pid;if(k[n]){var h=k[n];
for(var i=0;i<h.length;i++){var g=h[i];j=j+"<tr>";j=j+"<td>";j=j+mydmam.manager.prepareInstanceNameCell(o,g.instance);
j=j+"</td>";j=j+"<td>"+g.vendor+"<br>";j=j+'<span class="label label-inverse">'+i18n("useractions.functionalities.sections."+g.section)+"</span>";
if(g.powerful_and_dangerous){j=j+' <span class="label label-warning">'+i18n("manager.uafunctlist.powerful_and_dangerous")+"</span>";
}j=j+"</td>";j=j+"<td>";j=j+g.longname+"";j=j+'<span class="pull-right">'+mydmam.manager.jobs.view.displayClassName(g.classname)+"</span>";
j=j+"<br><small>"+g.description+"</small>";j=j+"</td>";j=j+"<td>";if(g.capability.fileprocessing_enabled){j=j+'<span class="label label-success">File</span>';
}if(g.capability.directoryprocessing_enabled){j=j+'<span class="label label-success">Directory</span>';
}if(g.capability.rootstorageindexprocessing_enabled){j=j+'<span class="label label-success">Root storage</span>';
}j=j+"</td>";j=j+"<td><small>";for(var f in g.capability.storageindexeswhitelist){var m=g.capability.storageindexeswhitelist[f];
if(jQuery.inArray(m,g.worker_capablity_storages)>-1){j=j+m+" ";}else{j=j+'<span class="muted">'+m+"</span> ";
}}j=j+"</small></td>";j=j+"</tr>";}}}j=j+"</tbody>";j=j+"</table>";return j;};$.ajax({url:mydmam.manager.url.allavailabilities,type:"POST",async:true,beforeSend:function(){$(b).html(i18n("manager.loading"));
},error:function(f,h,g){$(b).html('<div class="alert alert-info"><button type="button" class="close" data-dismiss="alert">&times;</button><strong>'+h+"</strong></div>");
},success:function(f){$(b).html(d(f));e();}});};})(window.mydmam.manager);