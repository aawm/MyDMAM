(function(a){a.Items=React.createClass({displayName:"Items",getInitialState:function(){return{items:{},interval:null,selected_instances:[],selected_item_classes:[]};
},componentWillMount:function(){this.refresh(true);},refresh:function(b){mydmam.async.request("instances","allitems",null,function(c){var d=this.state.selected_instances;
if(b){d=[];for(var e in c){d.push(e);}selected_item_classes=this.getAllClassesNames(c);
}this.setState({items:c,selected_instances:d,selected_item_classes:selected_item_classes});
}.bind(this));},componentDidMount:function(){},componentWillUnmount:function(){if(this.state.interval){clearInterval(this.state.interval);
}},onSelectInstance:function(e,d){if(e=="_all"){var b=[];if(d){for(var c in this.state.items){b.push(c);
}}this.setState({selected_instances:b});return;}var f=this.state.selected_instances.slice();
if(f.indexOf(e)==-1&&d){f.push(e);this.setState({selected_instances:f});}else{if(f.indexOf(e)>-1&&(d==false)){f.splice(f.indexOf(e),1);
this.setState({selected_instances:f});}}},onSelectItemClasses:function(c,d){if(c=="_all"){var b=[];
if(d){b=this.getAllClassesNames();}this.setState({selected_item_classes:b});return;
}var e=this.state.selected_item_classes.slice();if(e.indexOf(c)==-1&&d){e.push(c);
this.setState({selected_item_classes:e});}else{if(e.indexOf(c)>-1&&(d==false)){e.splice(e.indexOf(c),1);
this.setState({selected_item_classes:e});}}},getAllClassesNames:function(c){if(c==null){c=this.state.items;
}var b=[];for(var f in c){var c=c[f];for(var e in c){var d=c[e]["class"];if(b.indexOf(d)==-1){b.push(d);
}}}return b;},onGotoTheTop:function(b){b.preventDefault();$("html, body").scrollTop(0);
},render:function(){var d=[];for(var g in this.state.items){var j=this.state.items[g];
var i=this.props.summaries[g];var m=this.state.selected_instances.indexOf(g)>-1;var l=g;
if(i!=null){l=(React.createElement("span",null,i.instance_name," ",React.createElement("small",null,"(",i.app_name,")")));
}d.push(React.createElement(a.SelectNavItemInstance,{key:g,onClick:this.onSelectInstance,reference:g,checked:m},l));
}if(d.length>1){var m=this.state.selected_instances.length==d.length;d.splice(0,0,(React.createElement(a.SelectNavItemInstance,{key:"_all",onClick:this.onSelectInstance,reference:"_all",checked:m},"ALL")));
}var e=[];var f=this.getAllClassesNames();for(var k in f){var c=f[k];var m=this.state.selected_item_classes.indexOf(c)>-1;
e.push(React.createElement(a.SelectNavItemInstance,{key:k,onClick:this.onSelectItemClasses,reference:c,checked:m},c));
}if(e.length>1){var m=this.state.selected_item_classes.length==e.length;e.splice(0,0,(React.createElement(a.SelectNavItemInstance,{key:"_all",onClick:this.onSelectItemClasses,reference:"_all",checked:m},"ALL")));
}var b=[];for(var g in this.state.items){var j=this.state.items[g];for(var h in j){var n=j[h];
var o=mydmam.module.f.managerInstancesItems(n);if(o==null){o=(React.createElement("div",null,React.createElement("span",{className:"label label-inverse"},React.createElement("i",{className:"icon-barcode icon-white"})," ",n.key),React.createElement("code",{className:"json",style:{marginTop:10}},React.createElement("i",{className:"icon-indent-left"}),React.createElement("span",{className:"jsontitle"}," ",n["class"]," "),JSON.stringify(n.content,null," "))));
}b.push(React.createElement("div",{key:md5(g+" "+h),style:{marginBottom:12}},o));
}b.push(React.createElement("hr",{key:g,style:{marginBottom:10}}));}return(React.createElement("div",{className:"row-fluid"},React.createElement("div",{className:"span3"},React.createElement("div",{className:"well",style:{padding:8}},d,React.createElement("hr",null),e)),React.createElement("div",{className:"span9"})));
}});a.SelectNavItemInstance=React.createClass({displayName:"SelectNavItemInstance",getInitialState:function(){return{checked:this.props.checked};
},componentWillReceiveProps:function(b){this.setState({checked:b.checked});},onClick:function(b){b.preventDefault();
this.props.onClick(this.props.reference,!this.state.checked);this.setState({checked:!this.state.checked});
},render:function(){return(React.createElement("div",null,React.createElement("label",{className:"checkbox",onClick:this.onClick},React.createElement("input",{type:"checkbox",ref:"cb",checked:this.state.checked,onChange:this.onClick})," ",this.props.children)));
}});mydmam.module.register("AppManager",{managerInstancesItems:function(b){if(b["class"]!="AppManager"){return null;
}return(React.createElement("div",null,"Broker alive: ",b.content.brokeralive?"yes":"no",React.createElement("br",null),"Off hours: ",b.content.is_off_hours?"yes":"no",React.createElement("br",null),React.createElement(mydmam.async.pathindex.reactDate,{date:b.content.next_updater_refresh_date,i18nlabel:i18n("manager.items.AppManager.next_updater_refresh_date"),style:{marginLeft:0}})));
}});})(window.mydmam.async.manager);