(function(a){a.NavigatePage=React.createClass({displayName:"NavigatePage",getInitialState:function(){return{stat:{},pathindex:"",default_page_size:20,sort_order:[],externalpos:{}};
},navigateTo:function(f,i,d,c){var e=mydmam.stat;var h=md5(f);if(c==null){c=this.state.sort_order;
}var b="";if(this.state.inputboxsearch){if(f!==this.state.pathindex){this.state.inputboxsearch.value="";
}b=this.state.inputboxsearch.value;}b=JSON.stringify(b);var g={pathelementskeys:[h],page_from:i,page_size:d,scopes_element:[e.SCOPE_DIRLIST,e.SCOPE_PATHINFO,e.SCOPE_MTD_SUMMARY,e.SCOPE_COUNT_ITEMS],scopes_subelements:[e.SCOPE_MTD_SUMMARY,e.SCOPE_COUNT_ITEMS],search:b,sort:c};
document.body.style.cursor="wait";mydmam.async.request("stat","cache",g,function(o){document.body.style.cursor="default";
if(o[h]){this.setState({stat:o,pathindex:f,default_page_size:d,sort_order:c});var p=[];
for(var m in o){var n=o[m];if(!n.reference){continue;}if(!n.reference){continue;}if(mydmam.module.f.wantToHaveResolvedExternalPositions("pathindex",n.reference.directory,n.reference.storagename)){p.push(m);
}if(!n.items){continue;}for(var l in n.items){var k=n.items[l];if(!k.reference){continue;
}if(mydmam.module.f.wantToHaveResolvedExternalPositions("pathindex",k.reference.directory,k.reference.storagename)){p.push(l);
}}}var j=function(q){this.setState({externalpos:q});}.bind(this);mydmam.async.pathindex.resolveExternalPosition(p,j);
}else{if(i>0){this.navigateTo(f,0,d);}return;}window.location.hash=this.state.pathindex;
}.bind(this));},componentDidMount:function(){this.navigateTo(this.props.pathindex_destination,0,this.state.default_page_size);
},handlePaginationSwitchPage:function(c,b){if(b){this.navigateTo(this.state.pathindex,0,this.state.default_page_size*2);
}else{this.navigateTo(this.state.pathindex,c-1,this.state.default_page_size);}},handleOnClickANavigateToNewDest:function(c){c.preventDefault();
var b=$(c.currentTarget).data("navigatetarget");if(b==="../"){if(this.state.pathindex===""){return;
}if(this.state.pathindex.endsWith(":/")){b="";}else{b=this.state.pathindex.substring(0,this.state.pathindex.lastIndexOf("/"));
if(b.endsWith(":")){b+="/";}}}this.navigateTo(b,0,this.state.default_page_size);},handlechangeOrderSort:function(d,b){var c=[];
if(b!=null){var b=b.toUpperCase();if(d==="size"){c=[{colname:"directory",order:"ASC"},{colname:"size",order:b}];
}else{if(d==="date"){c=[{colname:"date",order:b}];}else{c=[{colname:"sortedfilename",order:b}];
}}}this.navigateTo(this.state.pathindex,0,this.state.default_page_size,c);},handleChangeSearchBox:function(c){if(!this.state.inputboxsearch){this.setState({inputboxsearch:c});
}var b=this.state.stat[md5(this.state.pathindex)];if(!b){return;}if(b.reference.directory){this.navigateTo(this.state.pathindex,0,this.state.default_page_size,null);
}},render:function(){var f=this.state.stat[md5(this.state.pathindex)];if(!f){return(React.createElement("div",null));
}var h=0;if(f.items){for(var i in f.items){var b=f.items[i];if(b.reference){if(b.reference.dateindex){h=b.reference.dateindex;
break;}}}}var g=null;var j=null;if(f.reference){g=f.reference.storagename;j=f.reference.path;
}var e=null;var d=null;if(f.search_return_nothing){e=(React.createElement(a.NoResultsSearch,null));
}else{if(f.items_total){d=(React.createElement(mydmam.async.pagination.reactBlock,{pagecount:Math.ceil(f.items_total/f.items_page_size),currentpage:f.items_page_from+1,onClickButton:this.handlePaginationSwitchPage}));
}}var c=false;if(this.state.inputboxsearch){c=this.state.inputboxsearch.value!="";
}return(React.createElement("div",null,React.createElement(a.BreadCrumb,{storagename:g,path:j,navigate:this.handleOnClickANavigateToNewDest}),React.createElement(a.HeaderItem,{stat:f,first_item_dateindex:h,pathindexkey:md5(this.state.pathindex),navigate:this.handleOnClickANavigateToNewDest,is_in_search:c,externalpos:this.state.externalpos}),React.createElement(mydmam.async.pathindex.reactMetadataFull,{reference:f.reference,mtdsummary:f.mtdsummary,navigate:this.handleOnClickANavigateToNewDest}),React.createElement(a.NavigateTable,{stat:f,navigate:this.handleOnClickANavigateToNewDest,changeOrderSort:this.handlechangeOrderSort,externalpos:this.state.externalpos}),d,e,React.createElement(a.SearchBox,{changeStateInputbox:this.handleChangeSearchBox})));
}});})(window.mydmam.async.navigate);