(function(b){if(!b.metadatas){b.metadatas={};}var d=b.metadatas;d.getFileURL=function(f,e,g){if(!mydmam.metadatas.url.metadatafile){return"";
}return mydmam.metadatas.url.metadatafile.replace("filehashparam1",f).replace("typeparam2",e).replace("fileparam3",g);
};d.ImageURL=function(e,f){if(f==null){return null;}return d.getFileURL(e,f.type,f.file);
};var c=function(f,e){if(e==null){e="full_size_thumbnail";}if(e==="full_size_thumbnail"){if(f.full_size_thumbnail){return f.full_size_thumbnail;
}else{e="cartridge_thumbnail";}}if(e==="cartridge_thumbnail"){if(f.cartridge_thumbnail){return f.cartridge_thumbnail;
}else{e="icon_thumbnail";}}if(e==="icon_thumbnail"){if(f.icon_thumbnail){return f.icon_thumbnail;
}}return null;};d.chooseTheCorrectImageURL=function(f,g,e){return d.ImageURL(f,c(g,e));
};d.Image=React.createClass({displayName:"Image",render:function(){var h=this.props.file_hash;
var j=this.props.previews;var g=this.props.prefered_size;var l=c(j,g);if(l===null){return null;
}var f=d.ImageURL(h,l);var i=l.options.width;var e=l.options.height;var k=null;if((i>0)&(e>0)){k=(React.createElement("img",{src:f,className:"img-polaroid",alt:i+"x"+e,style:{width:i,height:e}}));
}else{k=(React.createElement("img",{src:f,className:"img-polaroid"}));}return(React.createElement("div",{style:{marginBottom:"1em"}},k));
}});var a=React.createClass({displayName:"QualityTabs",handleClickSwitchSize:function(e){e.preventDefault();
this.props.onSwitchSize(!this.props.isbigsize);},handleClickSwitchQuality:function(e){e.preventDefault();
this.props.onChangeQuality($(e.currentTarget).data("qualid"));},render:function(){var f="icon-resize-full";
if(this.props.isbigsize){f="icon-resize-small";}var e=this.props.medias;var k=this.props.selectedquality;
var g=[];for(var j=0;j<e.length;j++){var h=classNames({active:(j===k)});g.push(React.createElement("li",{key:j,className:h},React.createElement("a",{href:e[j].url,style:{outline:"none"},onClick:this.handleClickSwitchQuality,"data-qualid":j},e[j].label)));
}g.push(React.createElement("li",{key:"switchsize"},React.createElement("a",{href:"",style:{outline:"none"},onClick:this.handleClickSwitchSize},React.createElement("i",{className:f}))));
return(React.createElement("ul",{className:"nav nav-tabs"},g));}});d.Video=React.createClass({displayName:"Video",getInitialState:function(){return{selectedquality:0,medias:[],isbigsize:false};
},componentDidMount:function(){var i=this.props.master_as_preview_url;var f=this.props.file_hash;
var g=this.props.mtdsummary.previews;var e=[];if(i){var h={};h.url=i;h.label="Original";
e.push(h);}if(g){if(g.video_hd_pvw){var h={};h.url=d.getFileURL(f,g.video_hd_pvw.type,g.video_hd_pvw.file);
h.label="HD";e.push(h);}if(g.video_sd_pvw){var h={};h.url=d.getFileURL(f,g.video_sd_pvw.type,g.video_sd_pvw.file);
h.label="SQ";e.push(h);}if(g.video_lq_pvw){var h={};h.url=d.getFileURL(f,g.video_lq_pvw.type,g.video_lq_pvw.file);
h.label="LQ";e.push(h);}}this.setState({medias:e});},handleChangeQuality:function(g){this.setState({selectedquality:g});
var f=React.findDOMNode(this.refs.videoplayer);var h=f.currentTime;f.load();f.play();
var e=function(){this.currentTime=h;f.removeEventListener("loadedmetadata",e);};f.addEventListener("loadedmetadata",e,false);
},handleSwitchSize:function(e){this.setState({isbigsize:e});},render:function(){var e=this.props.file_hash;
var k=this.props.mtdsummary.previews;if(this.state.medias.length===0){return null;
}var g=this.state.medias[this.state.selectedquality].url;var m=d.chooseTheCorrectImageURL(e,k);
var i=640;var n=360;var l=null;var f=this.state.isbigsize;if(f){i=null;n=null;l="container";
}var h=(React.createElement("video",{ref:"videoplayer",controls:"controls",className:l,width:i,height:n,preload:"auto",poster:m},i18n("browser.cantloadingplayer"),React.createElement("source",{src:g})));
var j=null;if(this.state.medias.length>1){j=(React.createElement("div",{className:"tabbable tabs-below"},React.createElement("div",{className:"tab-content"},h),React.createElement(a,{isbigsize:f,medias:this.state.medias,selectedquality:this.state.selectedquality,onChangeQuality:this.handleChangeQuality,onSwitchSize:this.handleSwitchSize})));
}else{j=h;}return(React.createElement("div",{style:{marginBottom:"1em"}},j));}});
d.Audio=React.createClass({displayName:"Audio",render:function(){var h=this.props.file_hash;
var i=this.props.mtdsummary.previews;var f=this.props.mtdsummary.mimetype;var e=this.props.reference;
var j=this.props.master_as_preview_url;var g=null;if(j){g=j;}else{if(i){g=d.getFileURL(h,i.audio_pvw.type,i.audio_pvw.file);
}}if(g==null){return null;}return(React.createElement("div",{style:{marginBottom:"1em"}},React.createElement("audio",{controls:"controls",preload:"auto"},i18n("browser.cantloadingplayer"),React.createElement("source",{src:g})),React.createElement("div",{className:"pull-right"},React.createElement(d.Image,{file_hash:h,previews:i,prefered_size:"cartridge_thumbnail"}))));
}});})(window.mydmam.async.pathindex);