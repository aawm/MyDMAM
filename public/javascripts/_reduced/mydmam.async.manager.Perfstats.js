(function(a){a.Perfstats=React.createClass({displayName:"Perfstats",getInitialState:function(){return{list:{},interval:null};
},componentWillMount:function(){this.refresh();},refresh:function(){mydmam.async.request("instances","allperfstats",null,function(b){this.setState({list:b});
}.bind(this));},componentDidMount:function(){this.setState({interval:setInterval(this.refresh,5000)});
},componentWillUnmount:function(){if(this.state.interval){clearInterval(this.state.interval);
}},render:function(){var b=[];for(var c in this.state.list){b.push(React.createElement(a.PerfstatsInstance,{key:c,instance:this.state.list[c]}));
}return(React.createElement("div",null,b));}});a.PerfstatsInstance=React.createClass({displayName:"PerfstatsInstance",render:function(){var l=this.props.instance;
var j=function(n){if(n>1000*1000*10){return mydmam.format.number(Math.round(n/(1000*1000)))+" MB";
}else{return mydmam.format.number(n)+" bytes";}};var b=null;if(l.now+2000<Date.now()){b=(React.createElement(mydmam.async.pathindex.reactSinceDate,{i18nlabel:"manager.perfstats.since",date:l.now}));
}var m=(l.freeMemory/l.maxMemory)*100;var f=((l.totalMemory/l.maxMemory)*100)-m;var h=((l.heapUsed/l.maxMemory)*100);
var g=((l.nonHeapUsed/l.maxMemory)*100);var c=[];for(var i in l.gc){var k=l.gc[i];
c.push(React.createElement("tr",{key:i},React.createElement("th",null,k.name),React.createElement("td",null,k.time/1000," sec"),React.createElement("td",null,k.count," items")));
}var e=null;if(l.os){var d=l.os;e=(React.createElement("table",{className:"table table-bordered table-striped table-condensed table-hover",style:{width:"inherit"}},React.createElement("tr",null,React.createElement("th",null,"CPU load"),React.createElement("td",null,"JVM process: ",Math.round(d.getProcessCpuLoad*100)/100),React.createElement("td",{colSpan:"2"},"System: ",Math.round(d.getSystemCpuLoad*100)/100)),React.createElement("tr",null,React.createElement("th",null,"JVM CPU time"),React.createElement("td",{colSpan:"3"},Math.round(d.getProcessCpuTime/(1000*1000*100))/100," sec")),React.createElement("tr",null,React.createElement("th",null,"Physical memory"),React.createElement("td",null,"Free: ",j(d.getFreePhysicalMemorySize)),React.createElement("td",null,"Total: ",j(d.getTotalPhysicalMemorySize)),React.createElement("td",null,"Used: ",Math.floor(((d.getTotalPhysicalMemorySize-d.getFreePhysicalMemorySize)/d.getTotalPhysicalMemorySize)*100),"%")),React.createElement("tr",null,React.createElement("th",null,"Swap"),React.createElement("td",null,"Free: ",j(d.getFreeSwapSpaceSize)),React.createElement("td",null,"Total: ",j(d.getTotalSwapSpaceSize)),React.createElement("td",null,"Used: ",Math.floor(((d.getTotalSwapSpaceSize-d.getFreeSwapSpaceSize)/d.getTotalSwapSpaceSize)*100),"%")),React.createElement("tr",null,React.createElement("td",{colSpan:"4"},"Committed virtual memory size: ",j(d.getCommittedVirtualMemorySize)))));
}return(React.createElement("div",null,React.createElement("h4",null,l.instance_name," ",React.createElement("small",{className:"muted"},l.pid,"@",l.host_name)," ",React.createElement("span",{className:"badge badge-important"},"Load ",Math.round(l.getSystemLoadAverage*100)/100)," ",b),React.createElement("div",{style:{marginLeft:"15px"}},"Memory free: ",j(l.freeMemory),", total: ",j(l.totalMemory),", max: ",j(l.maxMemory),".",React.createElement("br",null),React.createElement("div",{className:"progress",style:{width:"40%"}},React.createElement("div",{className:"bar bar-warning",style:{width:f+"%"}}),React.createElement("div",{className:"bar bar-success",style:{width:m+"%"}})),React.createElement("p",null,"Classes count unloaded: ",l.getUnloadedClassCount,", loaded: ",l.getLoadedClassCount,", total loaded: ",l.getTotalLoadedClassCount,", object pending finalization: ",l.getObjectPendingFinalizationCount),"Heap memory: ",React.createElement("span",{className:"text-info"},j(l.heapUsed)),", non heap: ",React.createElement("span",{className:"text-error"},j(l.nonHeapUsed)),React.createElement("br",null),React.createElement("div",{className:"progress",style:{width:"40%"}},React.createElement("div",{className:"bar bar-info",style:{width:h+"%"}}),React.createElement("div",{className:"bar bar-danger",style:{width:g+"%"}})),e,React.createElement("table",{className:"table table-bordered table-striped table-condensed table-hover",style:{width:"inherit"}},React.createElement("tbody",null,c))),React.createElement("hr",null)));
}});})(window.mydmam.async.manager);